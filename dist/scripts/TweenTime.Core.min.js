!function(Q,B){"object"==typeof exports&&"object"==typeof module?module.exports=B(require("signals"),require("gsap"),require("lodash")):"function"==typeof define&&define.amd?define(["signals","TweenMax","lodash"],B):"object"==typeof exports?exports.Core=B(require("signals"),require("gsap"),require("lodash")):(Q.TweenTime=Q.TweenTime||{},Q.TweenTime.Core=B(Q.signals,Q.TweenMax,Q._))}(this,function(__WEBPACK_EXTERNAL_MODULE_3__,__WEBPACK_EXTERNAL_MODULE_5__,__WEBPACK_EXTERNAL_MODULE_6__){return function(Q){function B(F){if(t[F])return t[F].exports;var e=t[F]={exports:{},id:F,loaded:!1};return Q[F].call(e.exports,e,e.exports,B),e.loaded=!0,e.exports}var t={};return B.m=Q,B.c=t,B.p="",B(0)}([function(module,exports,__webpack_require__){eval("'use strict';\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _Utils = __webpack_require__(1);\n\nvar _Utils2 = _interopRequireDefault(_Utils);\n\nvar _Timer = __webpack_require__(2);\n\nvar _Timer2 = _interopRequireDefault(_Timer);\n\nvar _Orchestrator = __webpack_require__(4);\n\nvar _Orchestrator2 = _interopRequireDefault(_Orchestrator);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar _ = __webpack_require__(6);\n\nvar Core = function () {\n  function Core(data) {\n    var options = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\n    _classCallCheck(this, Core);\n\n    this.data = data;\n    this.options = options;\n    this.timer = new _Timer2.default(options);\n    this.orchestrator = new _Orchestrator2.default(this.timer, this.data);\n  }\n\n  _createClass(Core, [{\n    key: 'setData',\n    value: function setData(data) {\n      this.data = data;\n      this.orchestrator.setData(data);\n    }\n  }, {\n    key: 'getData',\n    value: function getData() {\n      return this.data;\n    }\n  }, {\n    key: 'getItem',\n    value: function getItem(item_id) {\n      // In case we passed the item object directly return it.\n      if (item_id && (typeof item_id === 'undefined' ? 'undefined' : _typeof(item_id)) === 'object') {\n        return item_id;\n      }\n\n      return _.find(this.data, function (item) {\n        return item.id === item_id;\n      });\n    }\n  }, {\n    key: 'getCurrentTime',\n    value: function getCurrentTime() {\n      return this.timer.getCurrentTime();\n    }\n  }, {\n    key: 'getProperty',\n    value: function getProperty(prop_name, item_id_or_obj) {\n      // If we passed the item name get the object from it.\n      var item = this.getItem(item_id_or_obj);\n\n      // Return false if we have no item\n      if (!item) {\n        return false;\n      }\n\n      return _.find(item.properties, function (property) {\n        return property.name === prop_name;\n      });\n    }\n  }, {\n    key: 'getValues',\n    value: function getValues(item_id_or_obj) {\n      // If we passed the item name get the object from it.\n      var item = this.getItem(item_id_or_obj);\n\n      // Return false if we have no item\n      if (!item) {\n        return undefined;\n      }\n\n      return item.values;\n    }\n  }, {\n    key: 'getValue',\n    value: function getValue(prop_name, item_id_or_obj) {\n      // If we passed the item name get the object from it.\n      var values = this.getValues(item_id_or_obj);\n\n      // Return false if we have no item\n      if (!values) {\n        return undefined;\n      }\n\n      if (values[prop_name] !== undefined) {\n        return values[prop_name];\n      }\n      return undefined;\n    }\n  }, {\n    key: 'getKeyAt',\n    value: function getKeyAt(property, time_in_seconds) {\n      return _.find(property.keys, function (key) {\n        return key.time === time_in_seconds;\n      });\n    }\n  }, {\n    key: 'setValue',\n    value: function setValue(property, new_val) {\n      var time_in_seconds = arguments.length <= 2 || arguments[2] === undefined ? false : arguments[2];\n\n      var time = time_in_seconds;\n      if (time === false) {\n        time = this.timer.getCurrentTime() / 1000;\n      }\n      var key = this.getKeyAt(property, time);\n\n      if (key) {\n        // If we found a key, simply update the value.\n        key.val = new_val;\n      } else {\n        if (property.keys.length === 0) {\n          // If the property doesn't have any key simply the the value.\n          property.val = new_val;\n        } else {\n          // If we are not on a key but the property has other keys,\n          // create it and add it to the keys array.\n          key = { val: new_val, time: time, _property: property };\n          if (this.options.defaultEase) {\n            key.ease = this.options.defaultEase;\n          }\n          property.keys.push(key);\n          // Also sort the keys.\n          property.keys = _Utils2.default.sortKeys(property.keys);\n        }\n      }\n    }\n  }, {\n    key: 'getTotalDuration',\n    value: function getTotalDuration() {\n      return this.orchestrator.getTotalDuration();\n    }\n  }]);\n\n  return Core;\n}();\n\nmodule.exports = Core;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9Db3JlLmpzP2RjZjAiXSwibmFtZXMiOlsiXyIsInJlcXVpcmUiLCJDb3JlIiwiZGF0YSIsIm9wdGlvbnMiLCJ0aW1lciIsIm9yY2hlc3RyYXRvciIsInNldERhdGEiLCJpdGVtX2lkIiwiZmluZCIsIml0ZW0iLCJpZCIsImdldEN1cnJlbnRUaW1lIiwicHJvcF9uYW1lIiwiaXRlbV9pZF9vcl9vYmoiLCJnZXRJdGVtIiwicHJvcGVydGllcyIsInByb3BlcnR5IiwibmFtZSIsInVuZGVmaW5lZCIsInZhbHVlcyIsImdldFZhbHVlcyIsInRpbWVfaW5fc2Vjb25kcyIsImtleXMiLCJrZXkiLCJ0aW1lIiwibmV3X3ZhbCIsImdldEtleUF0IiwidmFsIiwibGVuZ3RoIiwiX3Byb3BlcnR5IiwiZGVmYXVsdEVhc2UiLCJlYXNlIiwicHVzaCIsInNvcnRLZXlzIiwiZ2V0VG90YWxEdXJhdGlvbiIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUVBOzs7O0FBQ0E7Ozs7QUFDQTs7Ozs7Ozs7QUFKQSxJQUFJQSxJQUFJLG1CQUFBQyxDQUFRLENBQVIsQ0FBUjs7SUFNTUMsSTtBQUNKLGdCQUFZQyxJQUFaLEVBQWdDO0FBQUEsUUFBZEMsT0FBYyx5REFBSixFQUFJOztBQUFBOztBQUM5QixTQUFLRCxJQUFMLEdBQVlBLElBQVo7QUFDQSxTQUFLQyxPQUFMLEdBQWVBLE9BQWY7QUFDQSxTQUFLQyxLQUFMLEdBQWEsb0JBQVVELE9BQVYsQ0FBYjtBQUNBLFNBQUtFLFlBQUwsR0FBb0IsMkJBQWlCLEtBQUtELEtBQXRCLEVBQTZCLEtBQUtGLElBQWxDLENBQXBCO0FBQ0Q7Ozs7NEJBRU9BLEksRUFBTTtBQUNaLFdBQUtBLElBQUwsR0FBWUEsSUFBWjtBQUNBLFdBQUtHLFlBQUwsQ0FBa0JDLE9BQWxCLENBQTBCSixJQUExQjtBQUNEOzs7OEJBRVM7QUFDUixhQUFPLEtBQUtBLElBQVo7QUFDRDs7OzRCQUVPSyxPLEVBQVM7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ZGFzaCcpO1xuXG5pbXBvcnQgVXRpbHMgZnJvbSAnLi9jb3JlL1V0aWxzJztcbmltcG9ydCBUaW1lciBmcm9tICcuL2NvcmUvVGltZXInO1xuaW1wb3J0IE9yY2hlc3RyYXRvciBmcm9tICcuL2NvcmUvT3JjaGVzdHJhdG9yJztcblxuY2xhc3MgQ29yZSB7XG4gIGNvbnN0cnVjdG9yKGRhdGEsIG9wdGlvbnMgPSB7fSkge1xuICAgIHRoaXMuZGF0YSA9IGRhdGE7XG4gICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcbiAgICB0aGlzLnRpbWVyID0gbmV3IFRpbWVyKG9wdGlvbnMpO1xuICAgIHRoaXMub3JjaGVzdHJhdG9yID0gbmV3IE9yY2hlc3RyYXRvcih0aGlzLnRpbWVyLCB0aGlzLmRhdGEpO1xuICB9XG5cbiAgc2V0RGF0YShkYXRhKSB7XG4gICAgdGhpcy5kYXRhID0gZGF0YTtcbiAgICB0aGlzLm9yY2hlc3RyYXRvci5zZXREYXRhKGRhdGEpO1xuICB9XG5cbiAgZ2V0RGF0YSgpIHtcbiAgICByZXR1cm4gdGhpcy5kYXRhO1xuICB9XG5cbiAgZ2V0SXRlbShpdGVtX2lkKSB7XG4gICAgLy8gSW4gY2FzZSB3ZSBwYXNzZWQgdGhlIGl0ZW0gb2JqZWN0IGRpcmVjdGx5IHJldHVybiBpdC5cbiAgICBpZiAoaXRlbV9pZCAmJiB0eXBlb2YgaXRlbV9pZCA9PT0gJ29iamVjdCcpIHtcbiAgICAgIHJldHVybiBpdGVtX2lkO1xuICAgIH1cblxuICAgIHJldHVybiBfLmZpbmQodGhpcy5kYXRhLCAoaXRlbSkgPT4gaXRlbS5pZCA9PT0gaXRlbV9pZCk7XG4gIH1cblxuICBnZXRDdXJyZW50VGltZSgpIHtcbiAgICByZXR1cm4gdGhpcy50aW1lci5nZXRDdXJyZW50VGltZSgpO1xuICB9XG5cbiAgZ2V0UHJvcGVydHkocHJvcF9uYW1lLCBpdGVtX2lkX29yX29iaikge1xuICAgIC8vIElmIHdlIHBhc3NlZCB0aGUgaXRlbSBuYW1lIGdldCB0aGUgb2JqZWN0IGZyb20gaXQuXG4gICAgbGV0IGl0ZW0gPSB0aGlzLmdldEl0ZW0oaXRlbV9pZF9vcl9vYmopO1xuXG4gICAgLy8gUmV0dXJuIGZhbHNlIGlmIHdlIGhhdmUgbm8gaXRlbVxuICAgIGlmICghaXRlbSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIHJldHVybiBfLmZpbmQoaXRlbS5wcm9wZXJ0aWVzLCBwcm9wZXJ0eSA9PiBwcm9wZXJ0eS5uYW1lID09PSBwcm9wX25hbWUpO1xuICB9XG5cbiAgZ2V0VmFsdWVzKGl0ZW1faWRfb3Jfb2JqKSB7XG4gICAgLy8gSWYgd2UgcGFzc2VkIHRoZSBpdGVtIG5hbWUgZ2V0IHRoZSBvYmplY3QgZnJvbSBpdC5cbiAgICBsZXQgaXRlbSA9IHRoaXMuZ2V0SXRlbShpdGVtX2lkX29yX29iaik7XG5cbiAgICAvLyBSZXR1cm4gZmFsc2UgaWYgd2UgaGF2ZSBubyBpdGVtXG4gICAgaWYgKCFpdGVtKSB7XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIHJldHVybiBpdGVtLnZhbHVlcztcbiAgfVxuXG4gIGdldFZhbHVlKHByb3BfbmFtZSwgaXRlbV9pZF9vcl9vYmopIHtcbiAgICAvLyBJZiB3ZSBwYXNzZWQgdGhlIGl0ZW0gbmFtZSBnZXQgdGhlIG9iamVjdCBmcm9tIGl0LlxuICAgIHZhciB2YWx1ZXMgPSB0aGlzLmdldFZhbHVlcyhpdGVtX2lkX29yX29iaik7XG5cbiAgICAvLyBSZXR1cm4gZmFsc2UgaWYgd2UgaGF2ZSBubyBpdGVtXG4gICAgaWYgKCF2YWx1ZXMpIHtcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgaWYgKHZhbHVlc1twcm9wX25hbWVdICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHJldHVybiB2YWx1ZXNbcHJvcF9uYW1lXTtcbiAgICB9XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuXG4gIGdldEtleUF0KHByb3BlcnR5LCB0aW1lX2luX3NlY29uZHMpIHtcbiAgICByZXR1cm4gXy5maW5kKHByb3BlcnR5LmtleXMsIGtleSA9PiBrZXkudGltZSA9PT0gdGltZV9pbl9zZWNvbmRzKTtcbiAgfVxuXG4gIHNldFZhbHVlKHByb3BlcnR5LCBuZXdfdmFsLCB0aW1lX2luX3NlY29uZHMgPSBmYWxzZSkge1xuICAgIGxldCB0aW1lID0gdGltZV9pbl9zZWNvbmRzO1xuICAgIGlmICh0aW1lID09PSBmYWxzZSkge1xuICAgICAgdGltZSA9IHRoaXMudGltZXIuZ2V0Q3VycmVudFRpbWUoKSAvIDEwMDA7XG4gICAgfVxuICAgIHZhciBrZXkgPSB0aGlzLmdldEtleUF0KHByb3BlcnR5LCB0aW1lKTtcblxuICAgIGlmIChrZXkpIHtcbiAgICAgIC8vIElmIHdlIGZvdW5kIGEga2V5LCBzaW1wbHkgdXBkYXRlIHRoZSB2YWx1ZS5cbiAgICAgIGtleS52YWwgPSBuZXdfdmFsO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIGlmIChwcm9wZXJ0eS5rZXlzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAvLyBJZiB0aGUgcHJvcGVydHkgZG9lc24ndCBoYXZlIGFueSBrZXkgc2ltcGx5IHRoZSB0aGUgdmFsdWUuXG4gICAgICAgIHByb3BlcnR5LnZhbCA9IG5ld192YWw7XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgLy8gSWYgd2UgYXJlIG5vdCBvbiBhIGtleSBidXQgdGhlIHByb3BlcnR5IGhhcyBvdGhlciBrZXlzLFxuICAgICAgICAvLyBjcmVhdGUgaXQgYW5kIGFkZCBpdCB0byB0aGUga2V5cyBhcnJheS5cbiAgICAgICAga2V5ID0ge3ZhbDogbmV3X3ZhbCwgdGltZTogdGltZSwgX3Byb3BlcnR5OiBwcm9wZXJ0eX07XG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMuZGVmYXVsdEVhc2UpIHtcbiAgICAgICAgICBrZXkuZWFzZSA9IHRoaXMub3B0aW9ucy5kZWZhdWx0RWFzZTtcbiAgICAgICAgfVxuICAgICAgICBwcm9wZXJ0eS5rZXlzLnB1c2goa2V5KTtcbiAgICAgICAgLy8gQWxzbyBzb3J0IHRoZSBrZXlzLlxuICAgICAgICBwcm9wZXJ0eS5rZXlzID0gVXRpbHMuc29ydEtleXMocHJvcGVydHkua2V5cyk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZ2V0VG90YWxEdXJhdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5vcmNoZXN0cmF0b3IuZ2V0VG90YWxEdXJhdGlvbigpO1xuICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gQ29yZTtcblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vQ29yZS5qc1xuICoqLyJdLCJzb3VyY2VSb290IjoiIn0=")},function(module,exports){eval("'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Utils = function () {\n  function Utils() {\n    _classCallCheck(this, Utils);\n  }\n\n  _createClass(Utils, null, [{\n    key: 'formatMinutes',\n    value: function formatMinutes(d) {\n      // convert milliseconds to seconds\n      var seconds = d / 1000;\n      var hours = Math.floor(seconds / 3600);\n      var minutes = Math.floor((seconds - hours * 3600) / 60);\n      seconds = seconds - minutes * 60;\n      var output = seconds + 's';\n      if (minutes) {\n        output = minutes + 'm ' + output;\n      }\n      if (hours) {\n        output = hours + 'h ' + output;\n      }\n      return output;\n    }\n  }, {\n    key: 'getClosestTime',\n    value: function getClosestTime(data, time) {\n      var objectId = arguments.length <= 2 || arguments[2] === undefined ? false : arguments[2];\n      var property_name = arguments.length <= 3 || arguments[3] === undefined ? false : arguments[3];\n      var timer = arguments.length <= 4 || arguments[4] === undefined ? false : arguments[4];\n      var tolerance = arguments.length <= 5 || arguments[5] === undefined ? 0.1 : arguments[5];\n\n      if (timer) {\n        var timer_time = timer.getCurrentTime() / 1000;\n        if (Math.abs(timer_time - time) <= tolerance) {\n          return timer_time;\n        }\n      }\n\n      if (objectId || property_name) {\n        for (var i = 0; i < data.length; i++) {\n          var item = data[i];\n          // Don't match item with itself, but allow property to match item start/end.\n          if (item.id !== objectId || property_name) {\n            // First check start & end.\n            if (Math.abs(item.start - time) <= tolerance) {\n              return item.start;\n            }\n\n            if (Math.abs(item.end - time) <= tolerance) {\n              return item.end;\n            }\n          }\n\n          // Test properties keys\n          for (var j = 0; j < item.properties.length; j++) {\n            var prop = item.properties[j];\n\n            // Don't match property with itself.\n            if (prop.keys && (item.id !== objectId || prop.name !== property_name)) {\n              for (var k = 0; k < prop.keys.length; k++) {\n                var key = prop.keys[k];\n                if (Math.abs(key.time - time) <= tolerance) {\n                  return key.time;\n                }\n              }\n            }\n          }\n        }\n      }\n      return false;\n    }\n  }, {\n    key: 'getPreviousKey',\n    value: function getPreviousKey(keys, time) {\n      var prevKey = false;\n      for (var i = 0; i < keys.length; i++) {\n        var key = keys[i];\n        if (key.time < time) {\n          prevKey = key;\n        } else {\n          return prevKey;\n        }\n      }\n      return prevKey;\n    }\n  }, {\n    key: 'sortKeys',\n    value: function sortKeys(keys) {\n      var compare = function compare(a, b) {\n        if (a.time < b.time) {\n          return -1;\n        }\n        if (a.time > b.time) {\n          return 1;\n        }\n        return 0;\n      };\n      return keys.sort(compare);\n    }\n  }, {\n    key: 'guid',\n    value: function guid() {\n      var s4 = function s4() {\n        return Math.floor((1 + Math.random()) * 0x10000).toString(16).substring(1);\n      };\n      return s4() + s4() + '-' + s4() + '-' + s4() + '-' + s4() + '-' + s4() + s4() + s4();\n    }\n  }]);\n\n  return Utils;\n}();\n\nexports.default = Utils;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9jb3JlL1V0aWxzLmpzPzhkMmYiXSwibmFtZXMiOlsiVXRpbHMiLCJkIiwic2Vjb25kcyIsImhvdXJzIiwiTWF0aCIsImZsb29yIiwibWludXRlcyIsIm91dHB1dCIsImRhdGEiLCJ0aW1lIiwib2JqZWN0SWQiLCJwcm9wZXJ0eV9uYW1lIiwidGltZXIiLCJ0b2xlcmFuY2UiLCJ0aW1lcl90aW1lIiwiZ2V0Q3VycmVudFRpbWUiLCJhYnMiLCJpIiwibGVuZ3RoIiwiaXRlbSIsImlkIiwic3RhcnQiLCJlbmQiLCJqIiwicHJvcGVydGllcyIsInByb3AiLCJrZXlzIiwibmFtZSIsImsiLCJrZXkiLCJwcmV2S2V5IiwiY29tcGFyZSIsImEiLCJiIiwic29ydCIsInM0IiwicmFuZG9tIiwidG9TdHJpbmciLCJzdWJzdHJpbmciXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7SUFBcUJBLEs7Ozs7Ozs7a0NBQ0VDLEMsRUFBRztBQUN0QjtBQUNBLFVBQUlDLFVBQVVELElBQUksSUFBbEI7QUFDQSxVQUFJRSxRQUFRQyxLQUFLQyxLQUFMLENBQVdILFVBQVUsSUFBckIsQ0FBWjtBQUNBLFVBQUlJLFVBQVVGLEtBQUtDLEtBQUwsQ0FBVyxDQUFDSCxVQUFVQyxRQUFRLElBQW5CLElBQTJCLEVBQXRDLENBQWQ7QUFDQUQsZ0JBQVVBLFVBQVVJLFVBQVUsRUFBOUI7QUFDQSxVQUFJQyxTQUFTTCxVQUFVLEdBQXZCO0FBQ0EsVUFBSUksT0FBSixFQUFhO0FBQ1hDLGlCQUFTRCxVQUFVLElBQVYsR0FBaUJDLE1BQTFCO0FBQ0Q7QUFDRCxVQUFJSixLQUFKLEVBQVc7QUFDVEksaUJBQVNKLFFBQVEsSUFBUixHQUFlSSxNQUF4QjtBQUNEO0FBQ0QsYUFBT0EsTUFBUDtBQUNEOzs7bUNBRXFCQyxJLEVBQU1DLEksRUFBK0U7QUFBQSxVQUF6RUMsUUFBeUUseURBQTlELEtBQThEO0FBQUEsVUFBdkRDLGFBQXVELHlEQUF2QyxLQUF1QztBQUFBLFVBQWhDQyxL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QyxDQUFtRCxFQUFuRCxFQUF1REMsU0FBdkQsQ0FBaUUsQ0FBakUsQ0FBUDtBQUNELE9BRkQ7QUFHQSxhQUFPSCxPQUFPQSxJQUFQLEdBQWMsR0FBZCxHQUFvQkEsSUFBcEIsR0FBMkIsR0FBM0IsR0FBaUNBLElBQWpDLEdBQXdDLEdBQXhDLEdBQThDQSxJQUE5QyxHQUFxRCxHQUFyRCxHQUEyREEsSUFBM0QsR0FBa0VBLElBQWxFLEdBQXlFQSxJQUFoRjtBQUNEOzs7Ozs7a0JBM0ZrQm5DLEsiLCJmaWxlIjoiMS5qcyIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIFV0aWxzIHtcbiAgc3RhdGljIGZvcm1hdE1pbnV0ZXMoZCkge1xuICAgIC8vIGNvbnZlcnQgbWlsbGlzZWNvbmRzIHRvIHNlY29uZHNcbiAgICBsZXQgc2Vjb25kcyA9IGQgLyAxMDAwO1xuICAgIGxldCBob3VycyA9IE1hdGguZmxvb3Ioc2Vjb25kcyAvIDM2MDApO1xuICAgIGxldCBtaW51dGVzID0gTWF0aC5mbG9vcigoc2Vjb25kcyAtIGhvdXJzICogMzYwMCkgLyA2MCk7XG4gICAgc2Vjb25kcyA9IHNlY29uZHMgLSBtaW51dGVzICogNjA7XG4gICAgbGV0IG91dHB1dCA9IHNlY29uZHMgKyAncyc7XG4gICAgaWYgKG1pbnV0ZXMpIHtcbiAgICAgIG91dHB1dCA9IG1pbnV0ZXMgKyAnbSAnICsgb3V0cHV0O1xuICAgIH1cbiAgICBpZiAoaG91cnMpIHtcbiAgICAgIG91dHB1dCA9IGhvdXJzICsgJ2ggJyArIG91dHB1dDtcbiAgICB9XG4gICAgcmV0dXJuIG91dHB1dDtcbiAgfVxuXG4gIHN0YXRpYyBnZXRDbG9zZXN0VGltZShkYXRhLCB0aW1lLCBvYmplY3RJZCA9IGZhbHNlLCBwcm9wZXJ0eV9uYW1lID0gZmFsc2UsIHRpbWVyID0gZmFsc2UsIHRvbGVyYW5jZSA9IDAuMSkge1xuICAgIGlmICh0aW1lcikge1xuICAgICAgdmFyIHRpbWVyX3RpbWUgPSB0aW1lci5nZXRDdXJyZW50VGltZSgpIC8gMTAwMDtcbiAgICAgIGlmIChNYXRoLmFicyh0aW1lcl90aW1lIC0gdGltZSkgPD0gdG9sZXJhbmNlKSB7XG4gICAgICAgIHJldHVybiB0aW1lcl90aW1lO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChvYmplY3RJZCB8fCBwcm9wZXJ0eV9uYW1lKSB7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdmFyIGl0ZW0gPSBkYXRhW2ldO1xuICAgICAgICAvLyBEb24ndCBtYXRjaCBpdGVtIHdpdGggaXRzZWxmLCBidXQgYWxsb3cgcHJvcGVydHkgdG8gbWF0Y2ggaXRlbSBzdGFydC9lbmQuXG4gICAgICAgIGlmIChpdGVtLmlkICE9PSBvYmplY3RJZCB8fCBwcm9wZXJ0eV9uYW1lKSB7XG4gICAgICAgICAgLy8gRmlyc3QgY2hlY2sgc3RhcnQgJiBlbmQuXG4gICAgICAgICAgaWYgKE1hdGguYWJzKGl0ZW0uc3RhcnQgLSB0aW1lKSA8PSB0b2xlcmFuY2UpIHtcbiAgICAgICAgICAgIHJldHVybiBpdGVtLnN0YXJ0O1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmIChNYXRoLmFicyhpdGVtLmVuZCAtIHRpbWUpIDw9IHRvbGVyYW5jZSkge1xuICAgICAgICAgICAgcmV0dXJuIGl0ZW0uZW5kO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFRlc3QgcHJvcGVydGllcyBrZXlzXG4gICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgaXRlbS5wcm9wZXJ0aWVzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgdmFyIHByb3AgPSBpdGVtLnByb3BlcnRpZXNbal07XG5cbiAgICAgICAgICAvLyBEb24ndCBtYXRjaCBwcm9wZXJ0eSB3aXRoIGl0c2VsZi5cbiAgICAgICAgICBpZiAocHJvcC5rZXlzICYmIChpdGVtLmlkICE9PSBvYmplY3RJZCB8fCBwcm9wLm5hbWUgIT09IHByb3BlcnR5X25hbWUpKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IHByb3Aua2V5cy5sZW5ndGg7IGsrKykge1xuICAgICAgICAgICAgICB2YXIga2V5ID0gcHJvcC5rZXlzW2tdO1xuICAgICAgICAgICAgICBpZiAoTWF0aC5hYnMoa2V5LnRpbWUgLSB0aW1lKSA8PSB0b2xlcmFuY2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ga2V5LnRpbWU7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgc3RhdGljIGdldFByZXZpb3VzS2V5KGtleXMsIHRpbWUpIHtcbiAgICB2YXIgcHJldktleSA9IGZhbHNlO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIGtleSA9IGtleXNbaV07XG4gICAgICBpZiAoa2V5LnRpbWUgPCB0aW1lKSB7XG4gICAgICAgIHByZXZLZXkgPSBrZXk7XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHByZXZLZXk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBwcmV2S2V5O1xuICB9XG5cbiAgc3RhdGljIHNvcnRLZXlzKGtleXMpIHtcbiAgICB2YXIgY29tcGFyZSA9IGZ1bmN0aW9uKGEsIGIpIHtcbiAgICAgIGlmIChhLnRpbWUgPCBiLnRpbWUpIHtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgfVxuICAgICAgaWYgKGEudGltZSA+IGIudGltZSkge1xuICAgICAgICByZXR1cm4gMTtcbiAgICAgIH1cbiAgICAgIHJldHVybiAwO1xuICAgIH07XG4gICAgcmV0dXJuIGtleXMuc29ydChjb21wYXJlKTtcbiAgfVxuXG4gIHN0YXRpYyBndWlkKCkge1xuICAgIHZhciBzNCA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIE1hdGguZmxvb3IoKDEgKyBNYXRoLnJhbmRvbSgpKSAqIDB4MTAwMDApLnRvU3RyaW5nKDE2KS5zdWJzdHJpbmcoMSk7XG4gICAgfTtcbiAgICByZXR1cm4gczQoKSArIHM0KCkgKyAnLScgKyBzNCgpICsgJy0nICsgczQoKSArICctJyArIHM0KCkgKyAnLScgKyBzNCgpICsgczQoKSArIHM0KCk7XG4gIH1cbn1cblxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vY29yZS9VdGlscy5qc1xuICoqLyJdLCJzb3VyY2VSb290IjoiIn0=")},function(module,exports,__webpack_require__){eval("'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Signals = __webpack_require__(3);\n\nvar Timer = function () {\n  function Timer() {\n    var options = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];\n\n    _classCallCheck(this, Timer);\n\n    // in millisecond\n    this.totalDuration = options.totalDuration || 240 * 1000;\n    // Use an array for the time for easier d3.js integration (used as data for timeseeker).\n    this.time = [0];\n    this.is_playing = false;\n    this.last_timeStamp = -1;\n    this.last_time = -1;\n    this.updated = new Signals.Signal();\n    this.statusChanged = new Signals.Signal();\n    this.durationChanged = new Signals.Signal();\n    this.seeked = new Signals.Signal();\n    this.update = this.update.bind(this);\n    window.requestAnimationFrame(this.update);\n  }\n\n  _createClass(Timer, [{\n    key: 'getCurrentTime',\n    value: function getCurrentTime() {\n      return this.time[0];\n    }\n  }, {\n    key: 'getDuration',\n    value: function getDuration() {\n      return this.totalDuration / 1000;\n    }\n  }, {\n    key: 'setDuration',\n    value: function setDuration(seconds) {\n      this.totalDuration = seconds * 1000;\n      this.durationChanged.dispatch(seconds);\n    }\n  }, {\n    key: 'play',\n    value: function play() {\n      this.is_playing = true;\n      this.statusChanged.dispatch(this.is_playing);\n    }\n  }, {\n    key: 'stop',\n    value: function stop() {\n      this.is_playing = false;\n      this.statusChanged.dispatch(this.is_playing);\n    }\n  }, {\n    key: 'toggle',\n    value: function toggle() {\n      this.is_playing = !this.is_playing;\n      this.statusChanged.dispatch(this.is_playing);\n    }\n  }, {\n    key: 'seek',\n    value: function seek(time) {\n      this.time[0] = time[0];\n      this.seeked.dispatch(this.time[0]);\n    }\n  }, {\n    key: 'update',\n    value: function update(timestamp) {\n      // Init timestamp\n      if (this.last_timeStamp === -1) {\n        this.last_timeStamp = timestamp;\n      }\n      var elapsed = timestamp - this.last_timeStamp;\n\n      if (this.is_playing) {\n        this.time[0] += elapsed;\n      }\n\n      if (this.time[0] >= this.totalDuration) {\n        // Stop timer when reaching the end.\n        this.time[0] = this.totalDuration;\n        this.stop();\n      }\n\n      this.updated.dispatch(this.time[0]);\n\n      this.last_timeStamp = timestamp;\n      this.last_time = this.time[0];\n      window.requestAnimationFrame(this.update);\n    }\n  }]);\n\n  return Timer;\n}();\n\nexports.default = Timer;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9jb3JlL1RpbWVyLmpzP2Q0YmUiXSwibmFtZXMiOlsiU2lnbmFscyIsInJlcXVpcmUiLCJUaW1lciIsIm9wdGlvbnMiLCJ0b3RhbER1cmF0aW9uIiwidGltZSIsImlzX3BsYXlpbmciLCJsYXN0X3RpbWVTdGFtcCIsImxhc3RfdGltZSIsInVwZGF0ZWQiLCJTaWduYWwiLCJzdGF0dXNDaGFuZ2VkIiwiZHVyYXRpb25DaGFuZ2VkIiwic2Vla2VkIiwidXBkYXRlIiwiYmluZCIsIndpbmRvdyIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsInNlY29uZHMiLCJkaXNwYXRjaCIsInRpbWVzdGFtcCIsImVsYXBzZWQiLCJzdG9wIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQUEsSUFBSUEsVUFBVSxtQkFBQUMsQ0FBUSxDQUFSLENBQWQ7O0lBRXFCQyxLO0FBQ25CLG1CQUEwQjtBQUFBLFFBQWRDLE9BQWMseURBQUosRUFBSTs7QUFBQTs7QUFDeEI7QUFDQSxTQUFLQyxhQUFMLEdBQXFCRCxRQUFRQyxhQUFSLElBQXlCLE1BQU0sSUFBcEQ7QUFDQTtBQUNBLFNBQUtDLElBQUwsR0FBWSxDQUFDLENBQUQsQ0FBWjtBQUNBLFNBQUtDLFVBQUwsR0FBa0IsS0FBbEI7QUFDQSxTQUFLQyxjQUFMLEdBQXNCLENBQUMsQ0FBdkI7QUFDQSxTQUFLQyxTQUFMLEdBQWlCLENBQUMsQ0FBbEI7QUFDQSxTQUFLQyxPQUFMLEdBQWUsSUFBSVQsUUFBUVUsTUFBWixFQUFmO0FBQ0EsU0FBS0MsYUFBTCxHQUFxQixJQUFJWCxRQUFRVSxNQUFaLEVBQXJCO0FBQ0EsU0FBS0UsZUFBTCxHQUF1QixJQUFJWixRQUFRVSxNQUFaLEVBQXZCO0FBQ0EsU0FBS0csTUFBTCxHQUFjLElBQUliLFFBQVFVLE1BQVosRUFBZDtBQUNBLFNBQUtJLE1BQUwsR0FBYyxLQUFLQSxNQUFMLENBQVlDLElBQVosQ0FBaUIsSUFBakIsQ0FBZDtBQUNBQyxXQUFPQyxxQkFBUCxDQUE2QixLQUFLSCxNQUFsQztBQUNEOzs7O3FDQUVnQjtBQUNmLGFBQU8sS0FBS1QsSUFBTCxDQUFVLENBQVYsQ0FBUDtBQUNEOzs7a0NBRWE7QUFDWixhQUFPLEtBQUtELGFBQUwsR0FBcUIsSUFBNUI7QUFDRDs7O2dDQUVXYyxPLEVBQVM7QUFDbkIsV0FBS2QsYUFBTCxHQUFxQmMsVUFBVSxJQUEvQjtBQUNBLFdBQUtOLGVBQUwsQ0FBcUJPLFFBQXJCLENBQThCRCxPQUE5QjtBQUNEOzs7MkJBRU07QUFDTCxXQUFLWixVQUFMLEdBQWtCLElBQWxCO0FBQ0EsV0FBS0ssYUFBTCxDQUFtQlEsUUFBbkIsQ0FBNEIsS0FBS2IsVUFBakM7QUFDRDs7OzJCQUVNO0FBQ0wsV0FBS0EsVUFBTCxHQUFrQixLQUFsQjtBQUNBLFdBQUtLLGFBQUwsQ0FBbUJRLFFBQW5CLENBQTRCLEtBQUtiLFVBQWpDO0FBQ0Q7Ozs2QkFFUTtBQUNQLFdBQUtBLFVBQUwsR0FBa0IsQ0FBQyxLQUFLQSxVQUF4QjtBQUNBLFdBQUtLLGFBQUwsQ0FBbUJRLFFBQW5CLENBQTRCLEtBQUtiLFVBQWpDO0FBQ0Q7Ozt5QkFFSUQsSSxFQUFNO0FBQ1QsV0FBS0EsSUFBTCxDQUFVLENBQVYsSUFBZUEsS0FBSyxDQUFMLENBQWY7QUFDQSxXQUFLUSxNQUFMLENBQVlNLFFBQVosQ0FBcUIsS0FBS2QsSUFBTCxDQUFVLENBQVYsQ0FBckI7QUFDRDs7OzJCQUVNZSxTLEVBQVc7QUFDaEI7QUFDQSxVQUFJLEtBQUtiLGNBQUwsS0FBd0IsQ0FBQyxDQUE3QixFQUFnQztBQUM5QixhQUFLQSxjQUFMLEdBQXNCYSxTQUF0QjtBQUNEO0FBQ0QsVUFBSUMsVUFBVUQsWUFBWSxLQUFLYixjQUEvQjs7QUFFQSxVQUFJLEtBQUtELFVBQVQsRUFBcUI7QUFDbkIsYUFBS0QsSUFBTCxDQUFVLENBQVYsS0FBZ0JnQixPQUFoQjtBQUNEOztBQUVELFVBQUksS0FBS2hCLElBQUwsQ0FBVSxDQUFWLEtBQWdCLEtBQUtELGFBQXpCLEVBQXdDO0FBQ3RDO0FBQ0EsYUFBS0MsSUFBTCxDQUFVLENBQVYsSUFBZSxLQUFLRCxhQUFwQjtBQUNBLGFBQUtrQixJQUFMO0FBQ0Q7O0FBRUQsV0FBS2IsT0FBTCxDQUFhVSxRQUFiLENBQXNCLEtBQUtkLElBQUwsQ0FBVSxDQUFWLENBQXRCOztBQUVBLFdBQUtFLGNBQUwsR0FBc0JhLFNBQXRCO0FBQ0EsV0FBS1osU0FBTCxHQUFpQixLQUFLSCxJQUFMLENBQVUsQ0FBVixDQUFqQjtBQUNBVyxhQUFPQyxxQkFBUCxDQUE2QixLQUFLSCxNQUFsQztBQUNEOzs7Ozs7a0JBeEVrQlosSyIsImZpbGUiOiIyLmpzIiwic291cmNlc0NvbnRlbnQiOlsibGV0IFNpZ25hbHMgPSByZXF1aXJlKCdqcy1zaWduYWxzJyk7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFRpbWVyIHtcbiAgY29uc3RydWN0b3Iob3B0aW9ucyA9IHt9KSB7XG4gICAgLy8gaW4gbWlsbGlzZWNvbmRcbiAgICB0aGlzLnRvdGFsRHVyYXRpb24gPSBvcHRpb25zLnRvdGFsRHVyYXRpb24gfHwgMjQwICogMTAwMDtcbiAgICAvLyBVc2UgYW4gYXJyYXkgZm9yIHRoZSB0aW1lIGZvciBlYXNpZXIgZDMuanMgaW50ZWdyYXRpb24gKHVzZWQgYXMgZGF0YSBmb3IgdGltZXNlZWtlcikuXG4gICAgdGhpcy50aW1lID0gWzBdO1xuICAgIHRoaXMuaXNfcGxheWluZyA9IGZhbHNlO1xuICAgIHRoaXMubGFzdF90aW1lU3RhbXAgPSAtMTtcbiAgICB0aGlzLmxhc3RfdGltZSA9IC0xO1xuICAgIHRoaXMudXBkYXRlZCA9IG5ldyBTaWduYWxzLlNpZ25hbCgpO1xuICAgIHRoaXMuc3RhdHVzQ2hhbmdlZCA9IG5ldyBTaWduYWxzLlNpZ25hbCgpO1xuICAgIHRoaXMuZHVyYXRpb25DaGFuZ2VkID0gbmV3IFNpZ25hbHMuU2lnbmFsKCk7XG4gICAgdGhpcy5zZWVrZWQgPSBuZXcgU2lnbmFscy5TaWduYWwoKTtcbiAgICB0aGlzLnVwZGF0ZSA9IHRoaXMudXBkYXRlLmJpbmQodGhpcyk7XG4gICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLnVwZGF0ZSk7XG4gIH1cblxuICBnZXRDdXJyZW50VGltZSgpIHtcbiAgICByZXR1cm4gdGhpcy50aW1lWzBdO1xuICB9XG5cbiAgZ2V0RHVyYXRpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMudG90YWxEdXJhdGlvbiAvIDEwMDA7XG4gIH1cblxuICBzZXREdXJhdGlvbihzZWNvbmRzKSB7XG4gICAgdGhpcy50b3RhbER1cmF0aW9uID0gc2Vjb25kcyAqIDEwMDA7XG4gICAgdGhpcy5kdXJhdGlvbkNoYW5nZWQuZGlzcGF0Y2goc2Vjb25kcyk7XG4gIH1cblxuICBwbGF5KCkge1xuICAgIHRoaXMuaXNfcGxheWluZyA9IHRydWU7XG4gICAgdGhpcy5zdGF0dXNDaGFuZ2VkLmRpc3BhdGNoKHRoaXMuaXNfcGxheWluZyk7XG4gIH1cblxuICBzdG9wKCkge1xuICAgIHRoaXMuaXNfcGxheWluZyA9IGZhbHNlO1xuICAgIHRoaXMuc3RhdHVzQ2hhbmdlZC5kaXNwYXRjaCh0aGlzLmlzX3BsYXlpbmcpO1xuICB9XG5cbiAgdG9nZ2xlKCkge1xuICAgIHRoaXMuaXNfcGxheWluZyA9ICF0aGlzLmlzX3BsYXlpbmc7XG4gICAgdGhpcy5zdGF0dXNDaGFuZ2VkLmRpc3BhdGNoKHRoaXMuaXNfcGxheWluZyk7XG4gIH1cblxuICBzZWVrKHRpbWUpIHtcbiAgICB0aGlzLnRpbWVbMF0gPSB0aW1lWzBdO1xuICAgIHRoaXMuc2Vla2VkLmRpc3BhdGNoKHRoaXMudGltZVswXSk7XG4gIH1cblxuICB1cGRhdGUodGltZXN0YW1wKSB7XG4gICAgLy8gSW5pdCB0aW1lc3RhbXBcbiAgICBpZiAodGhpcy5sYXN0X3RpbWVTdGFtcCA9PT0gLTEpIHtcbiAgICAgIHRoaXMubGFzdF90aW1lU3RhbXAgPSB0aW1lc3RhbXA7XG4gICAgfVxuICAgIHZhciBlbGFwc2VkID0gdGltZXN0YW1wIC0gdGhpcy5sYXN0X3RpbWVTdGFtcDtcblxuICAgIGlmICh0aGlzLmlzX3BsYXlpbmcpIHtcbiAgICAgIHRoaXMudGltZVswXSArPSBlbGFwc2VkO1xuICAgIH1cblxuICAgIGlmICh0aGlzLnRpbWVbMF0gPj0gdGhpcy50b3RhbER1cmF0aW9uKSB7XG4gICAgICAvLyBTdG9wIHRpbWVyIHdoZW4gcmVhY2hpbmcgdGhlIGVuZC5cbiAgICAgIHRoaXMudGltZVswXSA9IHRoaXMudG90YWxEdXJhdGlvbjtcbiAgICAgIHRoaXMuc3RvcCgpO1xuICAgIH1cblxuICAgIHRoaXMudXBkYXRlZC5kaXNwYXRjaCh0aGlzLnRpbWVbMF0pO1xuXG4gICAgdGhpcy5sYXN0X3RpbWVTdGFtcCA9IHRpbWVzdGFtcDtcbiAgICB0aGlzLmxhc3RfdGltZSA9IHRoaXMudGltZVswXTtcbiAgICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRoaXMudXBkYXRlKTtcbiAgfVxufVxuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9jb3JlL1RpbWVyLmpzXG4gKiovIl0sInNvdXJjZVJvb3QiOiIifQ==");
},function(module,exports){eval("module.exports = __WEBPACK_EXTERNAL_MODULE_3__;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwge1wicm9vdFwiOlwic2lnbmFsc1wiLFwiY29tbW9uanNcIjpcInNpZ25hbHNcIixcImNvbW1vbmpzMlwiOlwic2lnbmFsc1wiLFwiYW1kXCI6XCJzaWduYWxzXCJ9PzkwMzgiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEiLCJmaWxlIjoiMy5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV8zX187XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiBleHRlcm5hbCB7XCJyb290XCI6XCJzaWduYWxzXCIsXCJjb21tb25qc1wiOlwic2lnbmFsc1wiLFwiY29tbW9uanMyXCI6XCJzaWduYWxzXCIsXCJhbWRcIjpcInNpZ25hbHNcIn1cbiAqKiBtb2R1bGUgaWQgPSAzXG4gKiogbW9kdWxlIGNodW5rcyA9IDAgMVxuICoqLyJdLCJzb3VyY2VSb290IjoiIn0=")},function(module,exports,__webpack_require__){eval("'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Signals = __webpack_require__(3);\nvar TweenMax = __webpack_require__(5);\n\nvar Orchestrator = function () {\n  function Orchestrator(timer, data) {\n    _classCallCheck(this, Orchestrator);\n\n    this.update = this.update.bind(this);\n    this.timer = timer;\n    this.data = data;\n    this.mainTimeline = new TimelineMax({ paused: true });\n    this.onUpdate = new Signals.Signal();\n    this.timer.updated.add(this.update);\n    this.update(0);\n  }\n\n  _createClass(Orchestrator, [{\n    key: 'setData',\n    value: function setData(data) {\n      this.data = data;\n    }\n  }, {\n    key: 'getTotalDuration',\n    value: function getTotalDuration() {\n      return this.mainTimeline.totalDuration();\n    }\n  }, {\n    key: 'getEasing',\n    value: function getEasing() {\n      var key = arguments.length <= 0 || arguments[0] === undefined ? false : arguments[0];\n\n      if (key && key.ease) {\n        var ease_index = key.ease.split('.');\n        if (ease_index.length === 2 && window[ease_index[0]] && window[ease_index[0]][ease_index[1]]) {\n          return window[ease_index[0]][ease_index[1]];\n        }\n      }\n      return Quad.easeOut;\n    }\n  }, {\n    key: 'initSpecialProperties',\n    value: function initSpecialProperties(item) {\n      // Add a dom element for color tweening and other css properties.\n      item._domHelper = document.createElement('div');\n      for (var property_key = 0; property_key < item.properties.length; property_key++) {\n        var property = item.properties[property_key];\n        // Setup special properties\n        if (property.type && property.type === 'color') {\n          // If the property is a color mark it as css\n          property.css = true;\n        }\n\n        if (property.css) {\n          // If property is a css or a color value apply it to the domHelper element.\n          item._domHelper.style[property.name] = property.val;\n        }\n      }\n    }\n  }, {\n    key: 'initItemValues',\n    value: function initItemValues(item) {\n      item.values = {};\n      // item._isDirty = true\n      for (var property_key = 0; property_key < item.properties.length; property_key++) {\n        var property = item.properties[property_key];\n        if (property.keys.length) {\n          // Take the value of the first key as initial value.\n          // this.todo: update this when the value of the first key change. (when rebuilding the timeline, simply delete item.values before item._timeline)\n          property.val = property.keys[0].val;\n        }\n        item.values[property.name] = property.val;\n      }\n    }\n  }, {\n    key: 'update',\n    value: function update(timestamp) {\n      var seconds = timestamp / 1000;\n      var has_dirty_items = false;\n      var i;\n      var item;\n      var property;\n      var property_key;\n\n      for (i = 0; i < this.data.length; i++) {\n        item = this.data[i];\n        if (!item._domHelper) {\n          this.initSpecialProperties(item);\n        }\n\n        // create the values object to contain all properties\n        if (!item.values) {\n          this.initItemValues(item);\n        }\n\n        // Create the timeline if needed\n        if (!item._timeline) {\n          item._timeline = new TimelineMax();\n          this.mainTimeline.add(item._timeline, 0);\n          item._isDirty = true;\n        }\n\n        if (item._isDirty) {\n          has_dirty_items = true;\n        }\n\n        if (item._timeline && item._isDirty && item.properties) {\n          item._isDirty = false;\n          // item._timeline.clear();\n\n          for (property_key = 0; property_key < item.properties.length; property_key++) {\n            property = item.properties[property_key];\n            if (property._timeline) {\n              property._timeline.clear();\n            } else {\n              property._timeline = new TimelineMax();\n              item._timeline.add(property._timeline, 0);\n            }\n\n            var propertyTimeline = property._timeline;\n            var propName = property.name;\n\n            // If there is no key stop there and set value to default.\n            if (!property.keys.length) {\n              item.values[property.name] = property.val;\n              continue;\n            }\n\n            // Set the data values target object.\n            var data_target = item.values;\n            // Add a inital key, even if there is no animation to set the value from time 0.\n            var first_key = property.keys[0];\n\n            var tween_time = 0;\n            if (first_key) {\n              tween_time = Math.min(-1, first_key.time - 0.1);\n            }\n\n            var tween_duration = 0;\n            var val = {};\n            var easing = this.getEasing();\n            val.ease = easing;\n\n            if (property.css) {\n              data_target = item._domHelper;\n              val.css = {};\n              val.css[propName] = first_key ? first_key.val : property.val;\n            } else {\n              val[propName] = first_key ? first_key.val : property.val;\n            }\n\n            var tween = TweenMax.to(data_target, tween_duration, val);\n            propertyTimeline.add(tween, tween_time);\n\n            for (var key_index = 0; key_index < property.keys.length; key_index++) {\n              var key = property.keys[key_index];\n\n              if (key_index < property.keys.length - 1) {\n                var next_key = property.keys[key_index + 1];\n                tween_duration = next_key.time - key.time;\n\n                val = {};\n                easing = this.getEasing(next_key);\n                val.ease = easing;\n                if (property.css) {\n                  val.css = {};\n                  val.css[propName] = next_key.val;\n                } else {\n                  val[propName] = next_key.val;\n                }\n\n                tween = TweenMax.to(data_target, tween_duration, val);\n                propertyTimeline.add(tween, key.time);\n              }\n            }\n\n            // Directly seek the property timeline to update the value.\n            propertyTimeline.seek(seconds);\n          }\n          // Force main timeline to refresh but never try to go to < 0\n          // to prevent glitches when current time is 0.\n          if (seconds > 0) {\n            seconds = seconds - 0.0000001;\n          } else {\n            seconds = seconds + 0.0000001;\n          }\n        }\n      }\n\n      // Finally update the main timeline.\n      this.mainTimeline.seek(seconds);\n\n      // update the css properties.\n      for (i = 0; i < this.data.length; i++) {\n        item = this.data[i];\n        for (property_key = 0; property_key < item.properties.length; property_key++) {\n          property = item.properties[property_key];\n          if (property.css && property.keys.length) {\n            // Only css values.\n            item.values[property.name] = item._domHelper.style[property.name];\n          }\n        }\n      }\n\n      if (has_dirty_items) {\n        this.onUpdate.dispatch();\n      }\n    }\n  }]);\n\n  return Orchestrator;\n}();\n\nexports.default = Orchestrator;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9jb3JlL09yY2hlc3RyYXRvci5qcz81OTQ2Il0sIm5hbWVzIjpbIlNpZ25hbHMiLCJyZXF1aXJlIiwiVHdlZW5NYXgiLCJPcmNoZXN0cmF0b3IiLCJ0aW1lciIsImRhdGEiLCJ1cGRhdGUiLCJiaW5kIiwibWFpblRpbWVsaW5lIiwiVGltZWxpbmVNYXgiLCJwYXVzZWQiLCJvblVwZGF0ZSIsIlNpZ25hbCIsInVwZGF0ZWQiLCJhZGQiLCJ0b3RhbER1cmF0aW9uIiwia2V5IiwiZWFzZSIsImVhc2VfaW5kZXgiLCJzcGxpdCIsImxlbmd0aCIsIndpbmRvdyIsIlF1YWQiLCJlYXNlT3V0IiwiaXRlbSIsIl9kb21IZWxwZXIiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJwcm9wZXJ0eV9rZXkiLCJwcm9wZXJ0aWVzIiwicHJvcGVydHkiLCJ0eXBlIiwiY3NzIiwic3R5bGUiLCJuYW1lIiwidmFsIiwidmFsdWVzIiwia2V5cyIsInRpbWVzdGFtcCIsInNlY29uZHMiLCJoYXNfZGlydHlfaXRlbXMiLCJpIiwiaW5pdFNwZWNpYWxQcm9wZXJ0aWVzIiwiaW5pdEl0ZW1WYWx1ZXMiLCJfdGltZWxpbmUiLCJfaXNEaXJ0eSIsImNsZWFyIiwicHJvcGVydHlUaW1lbGluZSIsInByb3BOYW1lIiwiZGF0YV90YXJnZXQiLCJmaXJzdF9rZXkiLCJ0d2Vlbl90aW1lIiwiTWF0aCIsIm1pbiIsInRpbWUiLCJ0d2Vlbl9kdXJhdGlvbiIsImVhc2luZyIsImdldEVhc2luZyIsInR3ZWVuIiwidG8iLCJrZXlfaW5kZXgiLCJuZXh0X2tleSIsInNlZWsiLCJkaXNwYXRjaCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUFBLElBQUlBLFVBQVUsbUJBQUFDLENBQVEsQ0FBUixDQUFkO0FBQ0EsSUFBSUMsV0FBVyxtQkFBQUQsQ0FBUSxDQUFSLENBQWY7O0lBRXFCRSxZO0FBQ25CLHdCQUFZQyxLQUFaLEVBQW1CQyxJQUFuQixFQUF5QjtBQUFBOztBQUN2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LENBQVVvQyxDQUFWLENBQVA7QUFDQSxhQUFLYixlQUFlLENBQXBCLEVBQXVCQSxlQUFlSixLQUFLSyxVQUFMLENBQWdCVCxNQUF0RCxFQUE4RFEsY0FBOUQsRUFBOEU7QUFDNUVFLHFCQUFXTixLQUFLSyxVQUFMLENBQWdCRCxZQUFoQixDQUFYO0FBQ0EsY0FBSUUsU0FBU0UsR0FBVCxJQUFnQkYsU0FBU08sSUFBVCxDQUFjakIsTUFBbEMsRUFBMEM7QUFDeEM7QUFDQUksaUJBQUtZLE1BQUwsQ0FBWU4sU0FBU0ksSUFBckIsSUFBNkJWLEtBQUtDLFVBQUwsQ0FBZ0JRLEtBQWhCLENBQXNCSCxTQUFTSSxJQUEvQixDQUE3QjtBQUNEO0FBQ0Y7QUFDRjs7QUFFRCxVQUFJTSxlQUFKLEVBQXFCO0FBQ25CLGFBQUs3QixRQUFMLENBQWNvRCxRQUFkO0FBQ0Q7QUFDRjs7Ozs7O2tCQXBNa0I1RCxZIiwiZmlsZSI6IjQuanMiLCJzb3VyY2VzQ29udGVudCI6WyJsZXQgU2lnbmFscyA9IHJlcXVpcmUoJ2pzLXNpZ25hbHMnKTtcbmxldCBUd2Vlbk1heCA9IHJlcXVpcmUoJ2dzYXAnKTtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgT3JjaGVzdHJhdG9yIHtcbiAgY29uc3RydWN0b3IodGltZXIsIGRhdGEpIHtcbiAgICB0aGlzLnVwZGF0ZSA9IHRoaXMudXBkYXRlLmJpbmQodGhpcyk7XG4gICAgdGhpcy50aW1lciA9IHRpbWVyO1xuICAgIHRoaXMuZGF0YSA9IGRhdGE7XG4gICAgdGhpcy5tYWluVGltZWxpbmUgPSBuZXcgVGltZWxpbmVNYXgoe3BhdXNlZDogdHJ1ZX0pO1xuICAgIHRoaXMub25VcGRhdGUgPSBuZXcgU2lnbmFscy5TaWduYWwoKTtcbiAgICB0aGlzLnRpbWVyLnVwZGF0ZWQuYWRkKHRoaXMudXBkYXRlKTtcbiAgICB0aGlzLnVwZGF0ZSgwKTtcbiAgfVxuXG4gIHNldERhdGEoZGF0YSkge1xuICAgIHRoaXMuZGF0YSA9IGRhdGE7XG4gIH1cblxuICBnZXRUb3RhbER1cmF0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLm1haW5UaW1lbGluZS50b3RhbER1cmF0aW9uKCk7XG4gIH1cblxuICBnZXRFYXNpbmcoa2V5ID0gZmFsc2UpIHtcbiAgICBpZiAoa2V5ICYmIGtleS5lYXNlKSB7XG4gICAgICB2YXIgZWFzZV9pbmRleCA9IGtleS5lYXNlLnNwbGl0KCcuJyk7XG4gICAgICBpZiAoZWFzZV9pbmRleC5sZW5ndGggPT09IDIgJiYgd2luZG93W2Vhc2VfaW5kZXhbMF1dICYmIHdpbmRvd1tlYXNlX2luZGV4WzBdXVtlYXNlX2luZGV4WzFdXSkge1xuICAgICAgICByZXR1cm4gd2luZG93W2Vhc2VfaW5kZXhbMF1dW2Vhc2VfaW5kZXhbMV1dO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gUXVhZC5lYXNlT3V0O1xuICB9XG5cbiAgaW5pdFNwZWNpYWxQcm9wZXJ0aWVzKGl0ZW0pIHtcbiAgICAvLyBBZGQgYSBkb20gZWxlbWVudCBmb3IgY29sb3IgdHdlZW5pbmcgYW5kIG90aGVyIGNzcyBwcm9wZXJ0aWVzLlxuICAgIGl0ZW0uX2RvbUhlbHBlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGZvciAodmFyIHByb3BlcnR5X2tleSA9IDA7IHByb3BlcnR5X2tleSA8IGl0ZW0ucHJvcGVydGllcy5sZW5ndGg7IHByb3BlcnR5X2tleSsrKSB7XG4gICAgICB2YXIgcHJvcGVydHkgPSBpdGVtLnByb3BlcnRpZXNbcHJvcGVydHlfa2V5XTtcbiAgICAgIC8vIFNldHVwIHNwZWNpYWwgcHJvcGVydGllc1xuICAgICAgaWYgKHByb3BlcnR5LnR5cGUgJiYgcHJvcGVydHkudHlwZSA9PT0gJ2NvbG9yJykge1xuICAgICAgICAvLyBJZiB0aGUgcHJvcGVydHkgaXMgYSBjb2xvciBtYXJrIGl0IGFzIGNzc1xuICAgICAgICBwcm9wZXJ0eS5jc3MgPSB0cnVlO1xuICAgICAgfVxuXG4gICAgICBpZiAocHJvcGVydHkuY3NzKSB7XG4gICAgICAgIC8vIElmIHByb3BlcnR5IGlzIGEgY3NzIG9yIGEgY29sb3IgdmFsdWUgYXBwbHkgaXQgdG8gdGhlIGRvbUhlbHBlciBlbGVtZW50LlxuICAgICAgICBpdGVtLl9kb21IZWxwZXIuc3R5bGVbcHJvcGVydHkubmFtZV0gPSBwcm9wZXJ0eS52YWw7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgaW5pdEl0ZW1WYWx1ZXMoaXRlbSkge1xuICAgIGl0ZW0udmFsdWVzID0ge307XG4gICAgLy8gaXRlbS5faXNEaXJ0eSA9IHRydWVcbiAgICBmb3IgKHZhciBwcm9wZXJ0eV9rZXkgPSAwOyBwcm9wZXJ0eV9rZXkgPCBpdGVtLnByb3BlcnRpZXMubGVuZ3RoOyBwcm9wZXJ0eV9rZXkrKykge1xuICAgICAgdmFyIHByb3BlcnR5ID0gaXRlbS5wcm9wZXJ0aWVzW3Byb3BlcnR5X2tleV07XG4gICAgICBpZiAocHJvcGVydHkua2V5cy5sZW5ndGgpIHtcbiAgICAgICAgLy8gVGFrZSB0aGUgdmFsdWUgb2YgdGhlIGZpcnN0IGtleSBhcyBpbml0aWFsIHZhbHVlLlxuICAgICAgICAvLyB0aGlzLnRvZG86IHVwZGF0ZSB0aGlzIHdoZW4gdGhlIHZhbHVlIG9mIHRoZSBmaXJzdCBrZXkgY2hhbmdlLiAod2hlbiByZWJ1aWxkaW5nIHRoZSB0aW1lbGluZSwgc2ltcGx5IGRlbGV0ZSBpdGVtLnZhbHVlcyBiZWZvcmUgaXRlbS5fdGltZWxpbmUpXG4gICAgICAgIHByb3BlcnR5LnZhbCA9IHByb3BlcnR5LmtleXNbMF0udmFsO1xuICAgICAgfVxuICAgICAgaXRlbS52YWx1ZXNbcHJvcGVydHkubmFtZV0gPSBwcm9wZXJ0eS52YWw7XG4gICAgfVxuICB9XG5cbiAgdXBkYXRlKHRpbWVzdGFtcCkge1xuICAgIHZhciBzZWNvbmRzID0gdGltZXN0YW1wIC8gMTAwMDtcbiAgICB2YXIgaGFzX2RpcnR5X2l0ZW1zID0gZmFsc2U7XG4gICAgdmFyIGk7XG4gICAgdmFyIGl0ZW07XG4gICAgdmFyIHByb3BlcnR5O1xuICAgIHZhciBwcm9wZXJ0eV9rZXk7XG5cbiAgICBmb3IgKGkgPSAwOyBpIDwgdGhpcy5kYXRhLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpdGVtID0gdGhpcy5kYXRhW2ldO1xuICAgICAgaWYgKCFpdGVtLl9kb21IZWxwZXIpIHtcbiAgICAgICAgdGhpcy5pbml0U3BlY2lhbFByb3BlcnRpZXMoaXRlbSk7XG4gICAgICB9XG5cbiAgICAgIC8vIGNyZWF0ZSB0aGUgdmFsdWVzIG9iamVjdCB0byBjb250YWluIGFsbCBwcm9wZXJ0aWVzXG4gICAgICBpZiAoIWl0ZW0udmFsdWVzKSB7XG4gICAgICAgIHRoaXMuaW5pdEl0ZW1WYWx1ZXMoaXRlbSk7XG4gICAgICB9XG5cbiAgICAgIC8vIENyZWF0ZSB0aGUgdGltZWxpbmUgaWYgbmVlZGVkXG4gICAgICBpZiAoIWl0ZW0uX3RpbWVsaW5lKSB7XG4gICAgICAgIGl0ZW0uX3RpbWVsaW5lID0gbmV3IFRpbWVsaW5lTWF4KCk7XG4gICAgICAgIHRoaXMubWFpblRpbWVsaW5lLmFkZChpdGVtLl90aW1lbGluZSwgMCk7XG4gICAgICAgIGl0ZW0uX2lzRGlydHkgPSB0cnVlO1xuICAgICAgfVxuXG4gICAgICBpZiAoaXRlbS5faXNEaXJ0eSkge1xuICAgICAgICBoYXNfZGlydHlfaXRlbXMgPSB0cnVlO1xuICAgICAgfVxuXG4gICAgICBpZiAoaXRlbS5fdGltZWxpbmUgJiYgaXRlbS5faXNEaXJ0eSAmJiBpdGVtLnByb3BlcnRpZXMpIHtcbiAgICAgICAgaXRlbS5faXNEaXJ0eSA9IGZhbHNlO1xuICAgICAgICAvLyBpdGVtLl90aW1lbGluZS5jbGVhcigpO1xuXG4gICAgICAgIGZvciAocHJvcGVydHlfa2V5ID0gMDsgcHJvcGVydHlfa2V5IDwgaXRlbS5wcm9wZXJ0aWVzLmxlbmd0aDsgcHJvcGVydHlfa2V5KyspIHtcbiAgICAgICAgICBwcm9wZXJ0eSA9IGl0ZW0ucHJvcGVydGllc1twcm9wZXJ0eV9rZXldO1xuICAgICAgICAgIGlmIChwcm9wZXJ0eS5fdGltZWxpbmUpIHtcbiAgICAgICAgICAgIHByb3BlcnR5Ll90aW1lbGluZS5jbGVhcigpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHByb3BlcnR5Ll90aW1lbGluZSA9IG5ldyBUaW1lbGluZU1heCgpO1xuICAgICAgICAgICAgaXRlbS5fdGltZWxpbmUuYWRkKHByb3BlcnR5Ll90aW1lbGluZSwgMCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdmFyIHByb3BlcnR5VGltZWxpbmUgPSBwcm9wZXJ0eS5fdGltZWxpbmU7XG4gICAgICAgICAgdmFyIHByb3BOYW1lID0gcHJvcGVydHkubmFtZTtcblxuICAgICAgICAgIC8vIElmIHRoZXJlIGlzIG5vIGtleSBzdG9wIHRoZXJlIGFuZCBzZXQgdmFsdWUgdG8gZGVmYXVsdC5cbiAgICAgICAgICBpZiAoIXByb3BlcnR5LmtleXMubGVuZ3RoKSB7XG4gICAgICAgICAgICBpdGVtLnZhbHVlc1twcm9wZXJ0eS5uYW1lXSA9IHByb3BlcnR5LnZhbDtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIFNldCB0aGUgZGF0YSB2YWx1ZXMgdGFyZ2V0IG9iamVjdC5cbiAgICAgICAgICB2YXIgZGF0YV90YXJnZXQgPSBpdGVtLnZhbHVlcztcbiAgICAgICAgICAvLyBBZGQgYSBpbml0YWwga2V5LCBldmVuIGlmIHRoZXJlIGlzIG5vIGFuaW1hdGlvbiB0byBzZXQgdGhlIHZhbHVlIGZyb20gdGltZSAwLlxuICAgICAgICAgIHZhciBmaXJzdF9rZXkgPSBwcm9wZXJ0eS5rZXlzWzBdO1xuXG4gICAgICAgICAgdmFyIHR3ZWVuX3RpbWUgPSAwO1xuICAgICAgICAgIGlmIChmaXJzdF9rZXkpIHtcbiAgICAgICAgICAgIHR3ZWVuX3RpbWUgPSBNYXRoLm1pbigtMSwgZmlyc3Rfa2V5LnRpbWUgLSAwLjEpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHZhciB0d2Vlbl9kdXJhdGlvbiA9IDA7XG4gICAgICAgICAgdmFyIHZhbCA9IHt9O1xuICAgICAgICAgIHZhciBlYXNpbmcgPSB0aGlzLmdldEVhc2luZygpO1xuICAgICAgICAgIHZhbC5lYXNlID0gZWFzaW5nO1xuXG4gICAgICAgICAgaWYgKHByb3BlcnR5LmNzcykge1xuICAgICAgICAgICAgZGF0YV90YXJnZXQgPSBpdGVtLl9kb21IZWxwZXI7XG4gICAgICAgICAgICB2YWwuY3NzID0ge307XG4gICAgICAgICAgICB2YWwuY3NzW3Byb3BOYW1lXSA9IGZpcnN0X2tleSA/IGZpcnN0X2tleS52YWwgOiBwcm9wZXJ0eS52YWw7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFsW3Byb3BOYW1lXSA9IGZpcnN0X2tleSA/IGZpcnN0X2tleS52YWwgOiBwcm9wZXJ0eS52YWw7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdmFyIHR3ZWVuID0gVHdlZW5NYXgudG8oZGF0YV90YXJnZXQsIHR3ZWVuX2R1cmF0aW9uLCB2YWwpO1xuICAgICAgICAgIHByb3BlcnR5VGltZWxpbmUuYWRkKHR3ZWVuLCB0d2Vlbl90aW1lKTtcblxuICAgICAgICAgIGZvciAodmFyIGtleV9pbmRleCA9IDA7IGtleV9pbmRleCA8IHByb3BlcnR5LmtleXMubGVuZ3RoOyBrZXlfaW5kZXgrKykge1xuICAgICAgICAgICAgdmFyIGtleSA9IHByb3BlcnR5LmtleXNba2V5X2luZGV4XTtcblxuICAgICAgICAgICAgaWYgKGtleV9pbmRleCA8IHByb3BlcnR5LmtleXMubGVuZ3RoIC0gMSkge1xuICAgICAgICAgICAgICB2YXIgbmV4dF9rZXkgPSBwcm9wZXJ0eS5rZXlzW2tleV9pbmRleCArIDFdO1xuICAgICAgICAgICAgICB0d2Vlbl9kdXJhdGlvbiA9IG5leHRfa2V5LnRpbWUgLSBrZXkudGltZTtcblxuICAgICAgICAgICAgICB2YWwgPSB7fTtcbiAgICAgICAgICAgICAgZWFzaW5nID0gdGhpcy5nZXRFYXNpbmcobmV4dF9rZXkpO1xuICAgICAgICAgICAgICB2YWwuZWFzZSA9IGVhc2luZztcbiAgICAgICAgICAgICAgaWYgKHByb3BlcnR5LmNzcykge1xuICAgICAgICAgICAgICAgIHZhbC5jc3MgPSB7fTtcbiAgICAgICAgICAgICAgICB2YWwuY3NzW3Byb3BOYW1lXSA9IG5leHRfa2V5LnZhbDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YWxbcHJvcE5hbWVdID0gbmV4dF9rZXkudmFsO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgdHdlZW4gPSBUd2Vlbk1heC50byhkYXRhX3RhcmdldCwgdHdlZW5fZHVyYXRpb24sIHZhbCk7XG4gICAgICAgICAgICAgIHByb3BlcnR5VGltZWxpbmUuYWRkKHR3ZWVuLCBrZXkudGltZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gRGlyZWN0bHkgc2VlayB0aGUgcHJvcGVydHkgdGltZWxpbmUgdG8gdXBkYXRlIHRoZSB2YWx1ZS5cbiAgICAgICAgICBwcm9wZXJ0eVRpbWVsaW5lLnNlZWsoc2Vjb25kcyk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gRm9yY2UgbWFpbiB0aW1lbGluZSB0byByZWZyZXNoIGJ1dCBuZXZlciB0cnkgdG8gZ28gdG8gPCAwXG4gICAgICAgIC8vIHRvIHByZXZlbnQgZ2xpdGNoZXMgd2hlbiBjdXJyZW50IHRpbWUgaXMgMC5cbiAgICAgICAgaWYgKHNlY29uZHMgPiAwKSB7XG4gICAgICAgICAgc2Vjb25kcyA9IHNlY29uZHMgLSAwLjAwMDAwMDE7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgc2Vjb25kcyA9IHNlY29uZHMgKyAwLjAwMDAwMDE7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBGaW5hbGx5IHVwZGF0ZSB0aGUgbWFpbiB0aW1lbGluZS5cbiAgICB0aGlzLm1haW5UaW1lbGluZS5zZWVrKHNlY29uZHMpO1xuXG4gICAgLy8gdXBkYXRlIHRoZSBjc3MgcHJvcGVydGllcy5cbiAgICBmb3IgKGkgPSAwOyBpIDwgdGhpcy5kYXRhLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpdGVtID0gdGhpcy5kYXRhW2ldO1xuICAgICAgZm9yIChwcm9wZXJ0eV9rZXkgPSAwOyBwcm9wZXJ0eV9rZXkgPCBpdGVtLnByb3BlcnRpZXMubGVuZ3RoOyBwcm9wZXJ0eV9rZXkrKykge1xuICAgICAgICBwcm9wZXJ0eSA9IGl0ZW0ucHJvcGVydGllc1twcm9wZXJ0eV9rZXldO1xuICAgICAgICBpZiAocHJvcGVydHkuY3NzICYmIHByb3BlcnR5LmtleXMubGVuZ3RoKSB7XG4gICAgICAgICAgLy8gT25seSBjc3MgdmFsdWVzLlxuICAgICAgICAgIGl0ZW0udmFsdWVzW3Byb3BlcnR5Lm5hbWVdID0gaXRlbS5fZG9tSGVscGVyLnN0eWxlW3Byb3BlcnR5Lm5hbWVdO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGhhc19kaXJ0eV9pdGVtcykge1xuICAgICAgdGhpcy5vblVwZGF0ZS5kaXNwYXRjaCgpO1xuICAgIH1cbiAgfVxufVxuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9jb3JlL09yY2hlc3RyYXRvci5qc1xuICoqLyJdLCJzb3VyY2VSb290IjoiIn0=")},function(module,exports){eval("module.exports = __WEBPACK_EXTERNAL_MODULE_5__;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwge1wicm9vdFwiOlwiVHdlZW5NYXhcIixcImNvbW1vbmpzXCI6XCJnc2FwXCIsXCJjb21tb25qczJcIjpcImdzYXBcIixcImFtZFwiOlwiVHdlZW5NYXhcIn0/ODI2MCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSIsImZpbGUiOiI1LmpzIiwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFXzVfXztcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIGV4dGVybmFsIHtcInJvb3RcIjpcIlR3ZWVuTWF4XCIsXCJjb21tb25qc1wiOlwiZ3NhcFwiLFwiY29tbW9uanMyXCI6XCJnc2FwXCIsXCJhbWRcIjpcIlR3ZWVuTWF4XCJ9XG4gKiogbW9kdWxlIGlkID0gNVxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIl0sInNvdXJjZVJvb3QiOiIifQ==")},function(module,exports){eval("module.exports = __WEBPACK_EXTERNAL_MODULE_6__;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwge1wicm9vdFwiOlwiX1wiLFwiY29tbW9uanNcIjpcImxvZGFzaFwiLFwiY29tbW9uanMyXCI6XCJsb2Rhc2hcIixcImFtZFwiOlwibG9kYXNoXCJ9PzU1ZDAiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEiLCJmaWxlIjoiNi5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV82X187XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiBleHRlcm5hbCB7XCJyb290XCI6XCJfXCIsXCJjb21tb25qc1wiOlwibG9kYXNoXCIsXCJjb21tb25qczJcIjpcImxvZGFzaFwiLFwiYW1kXCI6XCJsb2Rhc2hcIn1cbiAqKiBtb2R1bGUgaWQgPSA2XG4gKiogbW9kdWxlIGNodW5rcyA9IDAgMVxuICoqLyJdLCJzb3VyY2VSb290IjoiIn0=")}])});