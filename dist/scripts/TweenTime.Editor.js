!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("lodash"),require(void 0),require("jquery"),require("d3"),require("DraggableNumber"),require("mustache"),require("spectrum")):"function"==typeof define&&define.amd?define(["lodash","signals","jquery","d3","DraggableNumber","mustache","spectrum"],e):"object"==typeof exports?exports.Editor=e(require("lodash"),require("./signals"),require("jquery"),require("d3"),require("DraggableNumber"),require("mustache"),require("spectrum")):(t.TweenTime=t.TweenTime||{},t.TweenTime.Editor=e(t._,t.signals,t.$,t.d3,t.DraggableNumber,t.Mustache,t.spectrum))}(this,function(t,e,i,n,r,s,a){return function(t){function e(n){if(i[n])return i[n].exports;var r=i[n]={exports:{},id:n,loaded:!1};return t[n].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){var n,r,s,a,o,l,h,u,p,d=function(t,e){return function(){return t.apply(e,arguments)}};p=i(12),h=i(5),o=i(6),s=i(7),r=i(8),l=i(9),a=i(10),u=i(11),n=function(){function t(t,e){this.tweenTime=t,this.options=null!=e?e:{},this.update=d(this.update,this),this.render=d(this.render,this),this.onKeyRemoved=d(this.onKeyRemoved,this),this.onKeyAdded=d(this.onKeyAdded,this),this.timer=this.tweenTime.timer,this.lastTime=-1,this.$timeline=$(p),$("body").append(this.$timeline),$("body").addClass("has-editor"),this.selectionManager=new l(this.tweenTime),this.exporter=new a(this),this.timeline=new h(this),this.propertiesEditor=new o(this,this.selectionManager),this.propertiesEditor.keyAdded.add(this.onKeyAdded),this.propertiesEditor.keyRemoved.add(this.onKeyRemoved),this.menu=new s(this.tweenTime,this.$timeline,this),null!=this.options.onMenuCreated&&this.options.onMenuCreated(this.$timeline.find(".timeline__menu")),this.controls=new r(this.tweenTime,this.$timeline),this.undoManager=new u(this),window.editorEnabled=!0,window.dispatchEvent(new Event("resize")),window.requestAnimationFrame(this.update)}return t.prototype.onKeyAdded=function(){return this.undoManager.addState(),this.render(!1,!0)},t.prototype.onKeyRemoved=function(t){return this.selectionManager.removeItem(t),this.undoManager.addState(),this.selectionManager.selection.length&&this.selectionManager.triggerSelect(),this.render(!1,!0)},t.prototype.render=function(t,e){return null==t&&(t=!1),null==e&&(e=!1),t===!1&&(t=this.timer.time[0]),e&&(this.timeline._isDirty=!0),this.timeline.render(t,e),this.controls.render(t,e),this.propertiesEditor.render(t,e)},t.prototype.update=function(){var t,e;return t=this.timer.time[0],e=this.lastTime===t?!1:!0,this.render(t,e),this.lastTime=this.timer.time[0],window.requestAnimationFrame(this.update)},t}(),t.exports=n},function(e){e.exports=t},function(t){var e;e=function(){function t(){}return t.formatMinutes=function(t){var e,i,n,r;return t/=1e3,e=Math.floor(t/3600),i=Math.floor((t-3600*e)/60),r=t-60*i,n=r+"s",i&&(n=i+"m "+n),e&&(n=e+"h "+n),n},t.getClosestTime=function(t,e,i,n,r,s){var a,o,l,h,u,p,d,c,m,f,g,y;if(null==i&&(i=!1),null==n&&(n=!1),null==r&&(r=!1),null==s&&(s=.1),r&&(h=r.getCurrentTime()/1e3,Math.abs(h-e)<=s))return h;if(i||n)for(u=0,c=t.length;c>u;u++){if(a=t[u],a.id!==i||n){if(Math.abs(a.start-e)<=s)return a.start;if(Math.abs(a.end-e)<=s)return a.end}for(g=a.properties,p=0,m=g.length;m>p;p++)if(l=g[p],l.keys&&(a.id!==i||l.name!==n))for(y=l.keys,d=0,f=y.length;f>d;d++)if(o=y[d],Math.abs(o.time-e)<=s)return o.time}return!1},t.getPreviousKey=function(t,e){var i,n,r,s;for(n=!1,r=0,s=t.length;s>r;r++){if(i=t[r],!(i.time<e))return n;n=i}return n},t.sortKeys=function(t){var e;return e=function(t,e){return t.time<e.time?-1:t.time>e.time?1:0},t.sort(e)},t.guid=function(){var t;return t=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)},t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()},t}(),t.exports=e},,,function(t,e,i){var n,r,s,a,o,l,h,u,p,d,c,m,f,g=function(t,e){return function(){return t.apply(e,arguments)}};n=i(15),m=i(16),c=i(2),s=i(17),p=i(18),a=i(19),l=i(20),h=i(21),o=i(22),r=i(23),u=i(24),f=function(t,e){var i,n;for(i in e)n=e[i],t[i]=n;return t},d=function(){function t(t){var e,i,n;this.editor=t,this.render=g(this.render,this),this.onUpdate=g(this.onUpdate,this),this.tweenTime=this.editor.tweenTime,this.timer=this.tweenTime.timer,this.selectionManager=this.editor.selectionManager,this._isDirty=!0,this.timer=this.tweenTime.timer,this.currentTime=this.timer.time,this.initialDomain=[0,2e4],i={top:6,right:20,bottom:0,left:265},this.margin=i,n=window.innerWidth-i.left-i.right,e=270-i.top-i.bottom-40,this.lineHeight=20,this.label_position_x=-i.left+20,this.x=m.time.scale().range([0,n]),this.x.domain(this.initialDomain),this.xAxis=m.svg.axis().scale(this.x).orient("top").tickSize(-e,0).tickFormat(c.formatMinutes),this.svg=m.select(".timeline__main").append("svg").attr("width",n+i.left+i.right).attr("height",600),this.svgContainer=this.svg.append("g").attr("transform","translate("+i.left+","+i.top+")"),this.svgContainerTime=this.svg.append("g").attr("transform","translate("+i.left+",0)"),this.linesContainer=this.svg.append("g").attr("transform","translate("+i.left+","+i.top+")"),this.header=new s(this.timer,this.initialDomain,this.tweenTime,n,i),this.timeIndicator=new p(this,this.svgContainerTime),this.selection=new u(this,this.svg,i),this.items=new a(this,this.linesContainer),this.items.onUpdate.add(this.onUpdate),this.keysPreview=new l(this,this.linesContainer),this.properties=new h(this),this.properties.onKeyAdded.add(function(t){return function(e,i){return t._isDirty=!0,t.render(0,!1),t.keys.selectNewKey(e,i)}}(this)),this.errors=new r(this),this.keys=new o(this),this.keys.onKeyUpdated.add(this.onUpdate),this.xAxisGrid=m.svg.axis().scale(this.x).ticks(100).tickSize(-this.items.dy,0).tickFormat("").orient("top"),this.xGrid=this.svgContainer.append("g").attr("class","x axis grid").attr("transform","translate(0,"+i.top+")").call(this.xAxisGrid),this.xAxisElement=this.svgContainer.append("g").attr("class","x axis").attr("transform","translate(0,"+i.top+")").call(this.xAxis),this.header.onBrush.add(function(t){return function(e){return t.x.domain(e),t.xGrid.call(t.xAxisGrid),t.xAxisElement.call(t.xAxis),t._isDirty=!0}}(this)),window.requestAnimationFrame(this.render),window.onresize=function(t){return function(){var e;return e=window.innerWidth,n=e-i.left-i.right,t.svg.attr("width",n+i.left+i.right),t.svg.selectAll(".timeline__right-mask").attr("width",e),t.x.range([0,n]),t._isDirty=!0,t.header.resize(e),t.render()}}(this)}return t.prototype.onUpdate=function(){return this.editor.render(!1,!0)},t.prototype.render=function(t,e){var i,n,r,s,a;return e&&(s=16,this.timer.getCurrentTime()>this.initialDomain[1]&&(n=this.initialDomain[1]-this.initialDomain[0],this.initialDomain[0]+=n-s,this.initialDomain[1]+=n-s,this.header.setDomain(this.initialDomain)),this.timer.getCurrentTime()<this.initialDomain[0]&&(n=this.initialDomain[1]-this.initialDomain[0],this.initialDomain[0]=this.timer.getCurrentTime(),this.initialDomain[1]=this.initialDomain[0]+n,this.header.setDomain(this.initialDomain))),(this._isDirty||e)&&(this.header.render(),this.timeIndicator.render()),this._isDirty?(i=this.items.render(),this.keysPreview.render(i),a=this.properties.render(i),this.errors.render(a),this.keys.render(a),this._isDirty=!1,r=Math.max(this.items.dy+30,230),this.xAxis.tickSize(-r,0),this.xAxisGrid.tickSize(-r,0),this.xGrid.call(this.xAxisGrid),this.xAxisElement.call(this.xAxis),this.svg.attr("height",r)):void 0},t}(),t.exports=d},function(t,e,i){var n,r,s,a,o,l,h=function(t,e){return function(){return t.apply(e,arguments)}};n=i(15),l=i(1),a=i(13),s=i(25),o=i(26),r=function(){function t(t){this.editor=t,this.render=h(this.render,this),this.addProperty=h(this.addProperty,this),this.onSelect=h(this.onSelect,this),this.onKeyAdded=h(this.onKeyAdded,this),this.timeline=this.editor.timeline,this.timer=this.editor.timer,this.selectionManager=t.selectionManager,this.$el=n(o),this.$container=this.$el.find(".properties-editor__main"),this.keyAdded=new a.Signal,this.keyRemoved=new a.Signal,this.items=[],n("body").addClass("properties-is-closed"),n("body").append(this.$el),this.selectionManager.onSelect.add(this.onSelect),this.$el.keypress(function(t){return t.stopPropagation()})}return t.prototype.onKeyAdded=function(){return console.log("on key added"),this.keyAdded.dispatch()},t.prototype.onSelect=function(t){var e,i,r;if(null==t&&(t=!1),this.items=[],this.$container.empty(),t instanceof Array)for(i=0,r=t.length;r>i;i++)e=t[i],this.addProperty(e);else this.addProperty(t);return this.items.length?n("body").removeClass("properties-is-closed"):void 0},t.prototype.addProperty=function(t){var e;return e=new s(this.editor,this.$container,t),e.keyAdded.add(this.onKeyAdded),this.items.push(e)},t.prototype.render=function(t,e){var i,n,r,s,a;if(e){for(s=this.items,a=[],n=0,r=s.length;r>n;n++)i=s[n],a.push(i.update());return a}},t}(),t.exports=r},function(t,e,i){var n,r;r=i(30),n=function(){function t(t,e,i){this.tweenTime=t,this.$timeline=e,this.editor=i,this.timer=this.tweenTime.timer,this.initExport(),this.initToggle()}return t.prototype.initToggle=function(){var t,e,i;return i=!1,t=this.$timeline.find('[data-action="toggle"]'),t.click(function(){return function(e){return e.preventDefault(),i=!i,t.toggleClass("menu-item--toggle-up",i),$("body").toggleClass("timeline-is-closed",i),window.dispatchEvent(new Event("resize"))}}(this)),e=$(".properties-editor").find('[data-action="toggle"]'),e.click(function(){return function(t){var e;return t.preventDefault(),e=!$("body").hasClass("properties-is-closed"),$("body").toggleClass("properties-is-closed",e),window.dispatchEvent(new Event("resize"))}}(this))},t.prototype.initExport=function(){var t,e;return e=this,t=this.editor.exporter,this.$timeline.find('[data-action="export"]').click(function(e){var i,n;return e.preventDefault(),n=t.getJSON(),i=new Blob([n],{type:"text/json;charset=utf-8"}),r(i,"data.json")})},t}(),t.exports=n},function(t){var e,i=function(t,e){return function(){return t.apply(e,arguments)}};e=function(){function t(t,e){this.tweenTime=t,this.$timeline=e,this.render=i(this.render,this),this.playPause=i(this.playPause,this),this.timer=this.tweenTime.timer,this.$time=this.$timeline.find(".control--time"),this.$time_end=this.$timeline.find(".control--time-end"),this.initControls(),this.$time_end.val(this.tweenTime.timer.getDuration()),$(document).keypress(function(t){return function(e){return console.log(e),32===e.charCode?t.playPause():void 0}}(this))}return t.prototype.playPause=function(){var t;return this.timer.toggle(),t=this.$timeline.find(".control--play-pause"),t.toggleClass("icon-pause",this.timer.is_playing),t.toggleClass("icon-play",!this.timer.is_playing)},t.prototype.initControls=function(){var t,e,i;return i=this.$timeline.find(".control--play-pause"),i.click(function(t){return function(e){return e.preventDefault(),t.playPause()}}(this)),t=this.$timeline.find(".control--first"),t.click(function(t){return function(e){return e.preventDefault(),t.timer.seek([0])}}(this)),e=this.$timeline.find(".control--last"),e.click(function(t){return function(e){var i;return e.preventDefault(),i=t.tweenTime.getTotalDuration(),t.timer.seek([1e3*i])}}(this)),this.$time.change(function(t){return function(){var e;return e=1e3*parseFloat(t.$time.val(),10),t.timer.seek([e])}}(this)),this.$time_end.change(function(t){return function(){var e;return e=parseFloat(t.$time_end.val(),10),t.timer.setDuration(e)}}(this))},t.prototype.render=function(t,e){var i;return e?(i=t/1e3,this.$time.val(i.toFixed(3))):void 0},t}(),t.exports=e},function(t,e,i){var n,r,s,a,o=function(t,e){return function(){return t.apply(e,arguments)}};a=i(16),r=i(13),s=i(2),n=function(){function t(t){this.tweenTime=t,this.getSelection=o(this.getSelection,this),this.triggerSelect=o(this.triggerSelect,this),this.reset=o(this.reset,this),this.sortSelection=o(this.sortSelection,this),this.removeItem=o(this.removeItem,this),this.removeDuplicates=o(this.removeDuplicates,this),this.selection=[],this.onSelect=new r.Signal}return t.prototype.removeDuplicates=function(){var t,e,i,n,r,s,a,o,l;for(n=[],l=this.selection,r=0,a=l.length;a>r;r++){for(e=l[r],t=!1,s=0,o=n.length;o>s;s++)if(i=n[s],e.isEqualNode(i)){t=!0;break}t===!1&&n.push(e)}return this.selection=n},t.prototype.removeItem=function(t){var e;return e=this.selection.indexOf(t),e>-1?this.selection.splice(e,1):void 0},t.prototype.sortSelection=function(){var t;return t=function(t,e){return t.__data__&&e.__data__?t.__data__.time<e.__data__.time?-1:t.__data__.time>e.__data__.time?1:0:0},this.selection=this.selection.sort(t)},t.prototype.reset=function(){return this.selection=[],this.highlightItems(),this.onSelect.dispatch(this.selection,!1)},t.prototype.triggerSelect=function(){return this.onSelect.dispatch(this.selection,!1)},t.prototype.select=function(t,e){var i,n,r;if(null==e&&(e=!1),e||(this.selection=[]),t instanceof Array)for(n=0,r=t.length;r>n;n++)i=t[n],this.selection.push(i);else this.selection.push(t);return this.removeDuplicates(),this.highlightItems(),this.sortSelection(),this.onSelect.dispatch(this.selection,e)},t.prototype.getSelection=function(){return this.selection},t.prototype.highlightItems=function(){var t,e,i,n,r,s;for(a.selectAll(".bar--selected").classed("bar--selected",!1),a.selectAll(".key--selected").classed("key--selected",!1),r=this.selection,s=[],i=0,n=r.length;n>i;i++)e=r[i],t=a.select(e),s.push(t.classed("bar")?t.classed("bar--selected",!0):t.classed("key")?t.classed("key--selected",!0):void 0);return s},t}(),t.exports=n},function(t){var e,i=function(t,e){return function(){return t.apply(e,arguments)}};e=function(){function t(t){this.editor=t,this.getJSON=i(this.getJSON,this),this.getData=i(this.getData,this)}return t.prototype.getData=function(){var t,e,i,n;return n=this.editor.tweenTime,t=this.editor.timeline.x.domain(),i=t[0],e=t[1],{settings:{time:n.timer.getCurrentTime(),duration:n.timer.getDuration(),domain:[i.getTime(),e.getTime()]},data:n.data}},t.prototype.getJSON=function(){var t,e,i,n;return n=this.editor.options,i=function(t,e){return 0===t.indexOf("_")?void 0:null!=n.json_replacer?n.json_replacer(t,e):e},t=this.getData(),e=JSON.stringify(t,i,2)},t}(),t.exports=e},function(t,e,i){var n,r,s=function(t,e){return function(){return t.apply(e,arguments)}};n=i(15),r=function(){function t(t){this.editor=t,this.setState=s(this.setState,this),this.addState=s(this.addState,this),this.redo=s(this.redo,this),this.undo=s(this.undo,this),this.history_max=100,this.history=[],this.current_index=0,this.addState(),n(document).keydown(function(t){return function(e){return 90===e.keyCode&&(e.metaKey||e.ctrlKey)?e.shiftKey?t.redo():t.undo():void 0}}(this))}return t.prototype.undo=function(){return this.current_index<=0?!1:(this.current_index-=1,this.setState(this.current_index))},t.prototype.redo=function(){return this.current_index>=this.history.length-1?!1:(this.current_index+=1,this.setState(this.current_index))},t.prototype.addState=function(){var t;return t=JSON.parse(this.editor.exporter.getJSON()),this.current_index+1<this.history.length&&this.history.splice(this.current_index+1,this.history.length-1),this.history.push(t),this.history.length>this.history_max&&this.history.shift(),this.current_index=this.history.length-1},t.prototype.setState=function(t){var e,i,n,r,s,a,o,l,h,u,p,d,c,m,f,g,y,v;for(h=this.history[t],e=h.data,u=this.editor.tweenTime,n=p=0,m=e.length;m>p;n=++p){if(i=e[n],u.data[n])for(y=i.properties,l=d=0,f=y.length;f>d;l=++d)if(o=y[l],u.data[n].properties[l])for(a=u.data[n].properties[l].keys,v=o.keys,s=c=0,g=v.length;g>c;s=++c)r=v[s],a[s]?(a[s].time=r.time,a[s].val=r.val,a[s].ease=r.ease):a[s]=r;else u.data[n].properties[l]=o;else u.data[n]=i;u.data[n]._isDirty=!0}return this.editor.render(!1,!0)},t}(),t.exports=r},function(t){t.exports='<div class=timeline><nav class=timeline__menu><a href=# class=menu-item data-action=export>Export</a> <a href=# class="menu-item menu-item--toggle" data-action=toggle><i class=icon-toggle></i></a></nav><div class="timeline__controls controls"><a href=# class="control control--first icon-first"></a> <a href=# class="control control--play-pause icon-play"></a> <a href=# class="control control--last icon-last"></a><input class="control control--input control--time"><span class=control__time-separator>/</span><input class="control control--input control--time-end"></div><div class=timeline__header></div><div class=timeline__main></div></div>'},function(t){t.exports=e},,function(t){t.exports=i},function(t){t.exports=n},function(t,e,i){var n,r,s,a,o,l=function(t,e){return function(){return t.apply(e,arguments)}};n=i(15),o=i(16),s=i(13),a=i(2),r=function(){function t(t,e,i,n,r){this.timer=t,this.initialDomain=e,this.tweenTime=i,this.resize=l(this.resize,this),this.createTimeHandle=l(this.createTimeHandle,this),this.render=l(this.render,this),this.createBrushHandle=l(this.createBrushHandle,this),this.onDurationChanged=l(this.onDurationChanged,this),this.setDomain=l(this.setDomain,this),this.adaptDomainToDuration=l(this.adaptDomainToDuration,this),this.onBrush=new s.Signal,this.margin={top:10,right:20,bottom:0,left:r.left},this.height=50-this.margin.top-this.margin.bottom+20,this.currentTime=this.timer.time,this.x=o.time.scale().range([0,n]),this.x.domain([0,this.timer.totalDuration]),this.xDisplayed=o.time.scale().range([0,n]),this.xDisplayed.domain(this.initialDomain),this.xAxis=o.svg.axis().scale(this.x).orient("top").tickSize(-5,0).tickFormat(a.formatMinutes),this.svg=o.select(".timeline__header").append("svg").attr("width",n+this.margin.left+this.margin.right).attr("height",56),this.svgContainer=this.svg.append("g").attr("transform","translate("+this.margin.left+","+this.margin.top+")"),this.createBrushHandle(),this.createTimeHandle(),this.timer.durationChanged.add(this.onDurationChanged)}return t.prototype.adaptDomainToDuration=function(t,e){var i,n;return i=1e3*e,n=[t[0],t[1]],n[0]=Math.min(n[0],i),n[1]=Math.min(n[1],i),n[0]=Math.max(n[0],0),n},t.prototype.setDomain=function(){return this.brush.x(this.x).extent(this.initialDomain),this.svgContainer.select(".brush").call(this.brush),this.onBrush.dispatch(this.initialDomain),this.render(),this.xDisplayed.domain(this.initialDomain)},t.prototype.onDurationChanged=function(t){return this.x.domain([0,this.timer.totalDuration]),this.xAxisElement.call(this.xAxis),this.initialDomain=this.adaptDomainToDuration(this.initialDomain,t),this.setDomain(this.initialDomain)},t.prototype.createBrushHandle=function(){var t;return this.xAxisElement=this.svgContainer.append("g").attr("class","x axis").attr("transform","translate(0,"+(this.margin.top+7)+")").call(this.xAxis),t=function(t){return function(){var e,i,n;return i=t.brush.extent(),n=i[0].getTime(),e=i[1].getTime(),t.initialDomain[0]=n,t.initialDomain[1]=e,t.setDomain(t.initialDomain)}}(this),this.brush=o.svg.brush().x(this.x).extent(this.initialDomain).on("brush",t),this.gBrush=this.svgContainer.append("g").attr("class","brush").call(this.brush).selectAll("rect").attr("height",20)},t.prototype.render=function(){var t;return t=this.svgContainer.selectAll(".time-indicator"),t.attr("transform","translate("+this.xDisplayed(this.currentTime[0])+", 25)")},t.prototype.createTimeHandle=function(){var t,e,i,n,r,s;return i=this,e=function(){var t,e,n,r,s,l;return e=o.event.sourceEvent,e.stopPropagation(),l=i.tweenTime,n=null!=e.x?e.x:e.clientX,t=i.xDisplayed.invert(n-i.margin.left),t=t.getTime(),t=Math.max(0,t),s=!1,e.shiftKey&&(r=t/1e3,s=a.getClosestTime(l.data,r,"---non-existant"),s!==!1&&(s=1e3*s)),s===!1&&(s=t),i.timer.seek([s])},t=o.behavior.drag().origin(function(t){return t}).on("drag",e),s=this.svgContainer.selectAll(".time-indicator").data(this.currentTime),n=s.enter().append("rect").attr("x",0).attr("y",20).attr("width",i.xDisplayed(i.timer.totalDuration)).attr("height",50).attr("fill-opacity",0).on("click",function(){var t,e;return e=o.mouse(this),t=i.xDisplayed.invert(e[0]),t=t.getTime(),t=Math.max(0,t),i.timer.seek([t])}),r=s.enter().append("g").attr("class","time-indicator").attr("transform","translate(-0.5,30)").call(t),r.append("rect").attr("class","time-indicator__line").attr("x",-.5).attr("y",0).attr("width",1).attr("height",1e3),r.append("path").attr("class","time-indicator__handle").attr("d","M -5 -3 L -5 5 L 0 10 L 5 5 L 5 -3 L -5 -3"),this.svgContainer.append("rect").attr("class","graph-mask").attr("x",-i.margin.left).attr("y",-i.margin.top).attr("width",i.margin.left-5).attr("height",i.height)},t.prototype.resize=function(t){return t=t-this.margin.left-this.margin.right,this.svg.attr("width",t+this.margin.left+this.margin.right),this.x.range([0,t]),this.xDisplayed.range([0,t]),this.xAxisElement.call(this.xAxis)},t}(),t.exports=r},function(t,e,i){var n,r,s,a,o=function(t,e){return function(){return t.apply(e,arguments)}};n=i(15),a=i(16),r=i(13),s=function(){function t(t,e){var i;this.timeline=t,this.container=e,this.render=o(this.render,this),this.timeSelection=this.container.selectAll(".time-indicator").data(this.timeline.currentTime),i=this.timeSelection.enter().append("svg").attr("class","time-indicator timeline__right-mask").attr("width",window.innerWidth-this.timeline.label_position_x).attr("height",442),this.timeSelection=i.append("rect").attr("class","time-indicator__line").attr("x",-1).attr("y",-this.timeline.margin.top-5).attr("width",1).attr("height",1e3)}return t.prototype.render=function(){return this.timeSelection=this.container.selectAll(".time-indicator rect"),this.timeSelection.attr("x",this.timeline.x(this.timeline.currentTime[0])-.5)},t}(),t.exports=s},function(t,e,i){var n,r,s,a,o,l=function(t,e){return function(){return t.apply(e,arguments)}};a=i(16),r=i(13),o=i(1),s=i(2),n=function(){function t(t,e){this.timeline=t,this.container=e,this.render=l(this.render,this),this.dy=10+this.timeline.margin.top,this.onUpdate=new r.Signal}return t.prototype.render=function(){var t,e,i,n,r,l,h,u,p,d,c,m,f,g;return f=this,g=f.timeline.tweenTime,m=function(){return f.timeline.selectionManager.select(this)},p=function(t){var e,i,n,r,s,o,l,h,u,p;if(i=f.timeline.x.invert(a.event.x).getTime()/1e3,e=i-t.start,t.start+=e,t.end+=e,t.properties)for(u=t.properties,s=0,l=u.length;l>s;s++)for(r=u[s],p=r.keys,o=0,h=p.length;h>o;o++)n=p[o],n.time+=e;return t._isDirty=!0,f.onUpdate.dispatch()},d=function(t){var e,i,n,r;return a.event.sourceEvent.stopPropagation(),n=a.event.sourceEvent,i=f.timeline.x.invert(a.event.x).getTime()/1e3,r=!1,n.shiftKey&&(r=s.getClosestTime(g.data,i,t.id,!1,g.timer)),r||(e=i-t.start,r=t.start+e),t.start=r,t._isDirty=!0,f.onUpdate.dispatch()},c=function(t){var e,i,n,r;return a.event.sourceEvent.stopPropagation(),n=a.event.sourceEvent,i=f.timeline.x.invert(a.event.x).getTime()/1e3,r=!1,n.shiftKey&&(r=s.getClosestTime(g.data,i,!1,!1,g.timer)),r||(e=i-t.end,r=t.end+e),t.end=r,t._isDirty=!0,f.onUpdate.dispatch()},h=a.behavior.drag().origin(function(){var t;return t=a.select(this),{x:t.attr("x"),y:t.attr("y")}}).on("drag",d),u=a.behavior.drag().origin(function(){var t;return t=a.select(this),{x:t.attr("x"),y:t.attr("y")}}).on("drag",c),l=a.behavior.drag().origin(function(){var t;return t=a.select(this),{x:t.attr("x"),y:t.attr("y")}}).on("drag",p),r=1,t=this.container.selectAll(".line-grp").data(this.timeline.tweenTime.data,function(t){return t.id}),i=t.enter().append("g").attr("class","line-grp"),e=i.append("svg").attr("class","timeline__right-mask").attr("width",window.innerWidth-f.timeline.label_position_x).attr("height",f.timeline.lineHeight),e.append("rect").attr("class","bar").attr("id",function(){return s.guid()}).attr("y",3).attr("height",14),e.append("rect").attr("class","bar-anchor bar-anchor--left").attr("y",2).attr("height",16).attr("width",6).call(h),e.append("rect").attr("class","bar-anchor bar-anchor--right").attr("y",2).attr("height",16).attr("width",6).call(u),f.dy=10+this.timeline.margin.top,t.attr("transform",function(t){var e,i,n;return n=f.dy,f.dy+=f.timeline.lineHeight,t.collapsed||(e=0,t.properties&&(i=o.filter(t.properties,function(t){return t.keys.length}),e=i.length),f.dy+=e*f.timeline.lineHeight),"translate(0,"+n+")"}),n=function(t){return null!=t.start&&null!=t.end?!0:!1},t.selectAll(".bar-anchor--left").filter(n).attr("x",function(t){return f.timeline.x(1e3*t.start)-1}).on("mousedown",function(){return a.event.stopPropagation()}),t.selectAll(".bar-anchor--right").filter(n).attr("x",function(t){return f.timeline.x(1e3*t.end)-1}).on("mousedown",function(){return a.event.stopPropagation()}),t.selectAll(".bar").filter(n).attr("x",function(t){return f.timeline.x(1e3*t.start)+r}).attr("width",function(t){return Math.max(0,1e3*(f.timeline.x(t.end)-f.timeline.x(t.start))-r)}).call(l).on("click",m).on("mousedown",function(){return a.event.stopPropagation()}),i.append("text").attr("class","line-label").attr("x",f.timeline.label_position_x+10).attr("y",16).text(function(t){return t.label}).on("click",m).on("mousedown",function(){return a.event.stopPropagation()}),f=this,i.append("text").attr("class","line__toggle").attr("x",f.timeline.label_position_x-10).attr("y",16).on("click",function(t){return t.collapsed=!t.collapsed,f.onUpdate.dispatch()}),t.selectAll(".line__toggle").text(function(t){return t.collapsed?"▸":"▾"}),i.append("line").attr("class","line-separator").attr("x1",-f.timeline.margin.left).attr("x2",f.timeline.x(f.timeline.timer.totalDuration+100)).attr("y1",f.timeline.lineHeight).attr("y2",f.timeline.lineHeight),t.exit().remove(),t},t}(),t.exports=n},function(t,e,i){var n,r,s=function(t,e){return function(){return t.apply(e,arguments)}};r=i(16),n=function(){function t(t,e){this.timeline=t,this.container=e,this.render=s(this.render,this)}return t.prototype.render=function(t){var e,i,n,s,a,o,l,h,u,p,d;return h=this,d=h.timeline.tweenTime,o=function(t){return t.properties?t.properties:[]},a=function(t){return t.name},l=t.selectAll(".keys-preview").data(o,a),p=l.enter().append("svg").attr("class","keys-preview timeline__right-mask").attr("width",window.innerWidth-h.timeline.label_position_x).attr("height",h.timeline.lineHeight),u=function(){var t,e;return e=r.select(this.parentNode.parentNode),t=e.datum(),t.collapsed===!0?"":"display: none;"},l.selectAll(".key--preview").attr("style",u),i=function(t){return t.keys},e=function(t){return t.time},s=l.selectAll(".key--preview").data(i,e),n=s.enter().append("path").attr("class","key--preview").attr("style",u).attr("d","M 0 -4 L 4 0 L 0 4 L -4 0"),s.attr("transform",function(t){var e,i;return e=h.timeline.x(1e3*t.time),e=parseInt(e,10),i=11,"translate("+e+","+i+")"}),s.exit().remove()},t}(),t.exports=n},function(t,e,i){var n,r,s,a;a=i(16),r=i(13),s=i(2),n=function(){function t(t){this.timeline=t,this.onKeyAdded=new r.Signal,this.subGrp=!1}return t.prototype.render=function(t){var e,i,n,r,o,l,h;return o=this,n=function(t){return t.properties?t.properties:[]},i=function(t){return t.name},h=function(t){return t.keys.length},r=t.selectAll(".line-item").data(n,i),e=0,l=r.enter().append("g").filter(h).attr("class","line-item"),o.subGrp=l,r.filter(h).attr("transform",function(t,e){var i;return i=(e+1)*o.timeline.lineHeight,"translate(0,"+i+")"}),l.append("rect").attr("class","click-handler click-handler--property").attr("x",0).attr("y",0).attr("width",o.timeline.x(o.timeline.timer.totalDuration+100)).attr("height",o.timeline.lineHeight).on("dblclick",function(t){var e,i,n,r,l,h,u,p;return r=this.parentNode.parentNode,l=a.select(r).datum(),e=t["default"]?t["default"]:0,h=a.mouse(this),i=o.timeline.x.invert(h[0]),i=i.getTime()/1e3,p=s.getPreviousKey(t.keys,i),p&&(e=p.val),u={time:i,val:e},t.keys.push(u),t.keys=s.sortKeys(t.keys),l._isDirty=!0,n=this.parentNode,o.onKeyAdded.dispatch(u,n)}),l.append("svg").attr("class","line-item__keys timeline__right-mask").attr("width",window.innerWidth-o.timeline.label_position_x).attr("height",o.timeline.lineHeight).attr("fill","#f00"),l.append("text").attr("class","line-label line-label--small").attr("x",o.timeline.label_position_x+10).attr("y",15).text(function(t){return t.name}),l.append("line").attr("class","line-separator--secondary").attr("x1",-o.timeline.margin.left).attr("x2",o.timeline.x(o.timeline.timer.totalDuration+100)).attr("y1",o.timeline.lineHeight).attr("y2",o.timeline.lineHeight),t.selectAll(".line-item").attr("display",function(){var t,e;return t=this.parentNode,e=a.select(t).datum(),e.collapsed?"none":"block"}),r},t}(),t.exports=n},function(t,e,i){var n,r,s,a,o;a=i(16),r=i(13),s=i(2),o=i(1),n=function(){function t(t){this.timeline=t,this.onKeyUpdated=new r.Signal}return t.prototype.selectNewKey=function(t,e){var i,n;return n=this,i=a.select(e).selectAll(".key").filter(function(e){return e.time===t.time}),i.length?(a.selectAll(".key--selected").classed("key--selected",!1),i.classed("key--selected",!0),i=i[0][0],n.timeline.selectionManager.select(i)):void 0},t.prototype.render=function(t){var e,i,n,r,l,h,u,p,d,c,m,f,g,y;return g=this,y=g.timeline.tweenTime,n=function(t){var e,i,n,r,l,h,u,p,d,c,m,f,v,_,x,w,k,D,b,T,C;if(w=a.event.sourceEvent,f=this.parentNode,p=f.parentNode.parentNode,m=a.select(f).datum(),u=a.select(p).datum(),e=g.timeline.x.domain()[0],d=a.mouse(this),c=t.time,n=g.timeline.x.invert(d[0]),n=n.getTime(),n=n/1e3-e/1e3,n=t.time+n,v=g.timeline.selectionManager.getSelection(),_=!1,x=!1,v.length&&(_=a.select(v[0]).datum().time,x=a.select(v[v.length-1]).datum().time),v=o.filter(v,function(t){return function(e){return e.isEqualNode(t)===!1}}(this)),k=!1,w.shiftKey&&(k=s.getClosestTime(y.data,n,u.id,m.name,y.timer)),k===!1&&(k=n),t.time=k,m.keys=s.sortKeys(m.keys),D=t.time-c,b=function(t){var e,i,n,r;return r=t.parentNode,n=a.select(r).datum(),i=r.parentNode.parentNode,e=a.select(i).datum(),e._isDirty=!0,n.keys=s.sortKeys(n.keys)},h=!1,r=!1,v.length)for(w.altKey&&null!=_&&null!=x&&(r=_===c,h=r?(x-t.time)/(x-c):(t.time-_)/(c-_)),T=0,C=v.length;C>T;T++)l=v[T],i=a.select(l).datum(),h===!1?i.time+=D:i.time=r?x-(x-i.time)*h:_+(i.time-_)*h,b(l);return u._isDirty=!0,g.onKeyUpdated.dispatch()},m=function(t){return t.keys},c=function(t){return t._id||(t._id=s.guid()),t._id},d=t.select(".line-item__keys").selectAll(".key").data(m,c),f=function(){var t,e;return e=a.event,e.sourceEvent&&(e=e.sourceEvent),t=e.shiftKey,a.event.type&&"dragstart"===a.event.type&&a.select(this).classed("key--selected")?void 0:g.timeline.selectionManager.select(this,t)},i=function(){return function(){return g.timeline.editor.undoManager.addState()}}(this),e=a.behavior.drag().origin(function(t){return t}).on("drag",n).on("dragstart",f).on("dragend",i),p=d.enter().append("g").attr("class","key").attr("id",function(t){return t._id}).on("mousedown",function(){return a.event.stopPropagation()}).call(e),t.selectAll(".key").attr("class",function(t){var e,i;return e="key",a.select(this).classed("key--selected")&&(e+=" key--selected"),t.ease?(i=t.ease.split("."),2===i.length&&(e+=" "+i[1])):e+=" easeOut",e}),h=p.append("g").attr("class","ease-linear"),h.append("path").attr("class","key__shape-arrow").attr("d","M 0 -6 L 6 0 L 0 6"),h.append("path").attr("class","key__shape-arrow").attr("d","M 0 -6 L -6 0 L 0 6"),r=p.append("g").attr("class","ease-in"),r.append("path").attr("class","key__shape-rect").attr("d","M 0 -6 L 0 6 L 4 5 L 1 0 L 4 -5"),r.append("path").attr("class","key__shape-arrow").attr("d","M 0 -6 L -6 0 L 0 6"),u=p.append("g").attr("class","ease-out"),u.append("path").attr("class","key__shape-rect").attr("d","M 0 -6 L 0 6 L -4 5 L -1 0 L -4 -5"),u.append("path").attr("class","key__shape-arrow").attr("d","M 0 -6 L 6 0 L 0 6"),l=p.append("g").attr("class","ease-inout"),l.append("circle").attr("cx",0).attr("cy",0).attr("r",5),d.attr("transform",function(t){var e,i;return e=g.timeline.x(1e3*t.time),e=parseInt(e,10),i=10,"translate("+e+","+i+")"}),d.exit().remove()},t}(),t.exports=n},function(t,e,i){var n,r,s,a;a=i(16),r=i(13),s=i(2),n=function(){function t(t){this.timeline=t}return t.prototype.render=function(t){var e,i,n,r,s,a,o;
return a=this,o=a.timeline.properties.subGrp,s=function(t){return null!=t.errors},n=o.insert("svg",":first-child").attr("class","line-item__errors").attr("width",window.innerWidth-a.timeline.label_position_x).attr("height",a.timeline.lineHeight),r=function(t){return t.errors},e=function(t){return t.time},i=t.filter(s).select(".line-item__errors").selectAll(".error").data(r,e),i.enter().append("rect").attr("class","error").attr("width",4).attr("height",a.timeline.lineHeight-1).attr("y","1"),t.selectAll(".error").attr("x",function(t){var e;return e=a.timeline.x(1e3*t.time)}),i.exit().remove()},t}(),t.exports=n},function(t){var e,i=function(t,e){return function(){return t.apply(e,arguments)}};e=function(){function t(t,e,n){this.timeline=t,this.svg=e,this.margin=n,this.onMouseUp=i(this.onMouseUp,this),this.init()}return t.prototype.onMouseUp=function(){return this.svg.selectAll(".selection").remove(),$("body").css({"user-select":"all"})},t.prototype.init=function(){var t;return t=this,this.svg.on("mousedown",function(){var e;return e=d3.mouse(this),t.svg.append("rect").attr({"class":"selection",x:e[0],y:e[1],width:0,height:0}),t.timeline.selectionManager.reset(),$("body").css({"user-select":"none"})}).on("mousemove",function(){var e,i,n,r,s,a,o;return a=t.svg.select(".selection"),a.empty()?void 0:(s=d3.mouse(this),{margin:t.margin},i={x:parseInt(a.attr("x"),10),y:parseInt(a.attr("y"),10),width:parseInt(a.attr("width"),10),height:parseInt(a.attr("height"),10)},s[0]=Math.max(t.margin.left,s[0]),r={x:s[0]-i.x,y:s[1]-i.y},r.x<1||2*r.x<i.width?(i.x=s[0],i.width-=r.x):i.width=r.x,r.y<1||2*r.y<i.height?(i.y=s[1],i.height-=r.y):i.height=r.y,a.attr(i),i.x-=t.margin.left,n=6,i.timeStart=t.timeline.x.invert(i.x-n).getTime()/1e3,i.timeEnd=t.timeline.x.invert(i.x+i.width+n).getTime()/1e3,e=t.svg[0][0].getBoundingClientRect(),d3.selectAll(".key--selected").classed("key--selected",!1),t.timeline.selectionManager.reset(),o=[],d3.selectAll(".key").each(function(t){var n,r,s;return r=d3.select(this.parentNode.parentNode.parentNode).datum(),r.collapsed!==!0&&(n=d3.select(this)[0][0].getBoundingClientRect(),s=n.top-e.top,t.time>=i.timeStart&&t.time<=i.timeEnd&&(s>=i.y&&s<=i.y+i.height||s+10>=i.y&&s+10<=i.y+i.height))?(d3.select(this).classed("key--selected",!0),o.push(this)):void 0}),t.timeline.selectionManager.select(o))}),$(window).on("mouseup",this.onMouseUp)},t}(),t.exports=e},function(t,e,i){var n,r,s,a,o,l=function(t,e){return function(){return t.apply(e,arguments)}};o=i(13),s=i(27),r=i(28),a=i(29),n=function(){function t(t,e,i){var n,r,s,a,h,u,p,d,c,m,f,g,y,v,_;this.editor=t,this.$el=e,this.update=l(this.update,this),this.addTweenProperty=l(this.addTweenProperty,this),this.addNumberProperty=l(this.addNumberProperty,this),this.createGroupContainer=l(this.createGroupContainer,this),this.onKeyAdded=l(this.onKeyAdded,this),this.timeline=this.editor.timeline,this.timer=this.editor.timer,this.selectionManager=t.selectionManager,this.keyAdded=new o.Signal,this.items=[],this.numberProp=!1,this.tweenProp=!1,a=d3.select(i),p=!1,g=!1,f=!1,c=!1,d=!1,a.classed("key")&&(g=i.parentNode,c=g.parentNode.parentNode,d=d3.select(c).datum(),f=d3.select(g).datum(),p=a.datum()),a.classed("bar")&&(d=a.datum()),a.classed("line-label")&&(i=i.parentNode,a=d3.select(i),d=a.datum()),y=!1,f&&(y=f.name),n=this.getContainer(d),s=n,_=d.properties;for(u in _)h=_[u],y&&h.name!==y||(r=this.getGroupContainer(h,n),m=this.addNumberProperty(h,d,p,r),this.items.push(m),h.name===y&&(s=r));y&&(v=this.addTweenProperty(h,d,p,s,f,i),this.items.push(v))}return t.prototype.onKeyAdded=function(){return this.keyAdded.dispatch()},t.prototype.getGroupContainer=function(t,e){var i,n,r;return t.group?(r="property-grp--"+t.group,i=e.find("."+r),i.length?i:(n=this.createGroupContainer(r,t.group),e.append(n),n)):(r="property-grp--general",i=e.find("."+r),i.length?i:(n=this.createGroupContainer(r),e.append(n),n))},t.prototype.createGroupContainer=function(t,e){var i;return null==e&&(e=!1),i=$('<div class="property-grp '+t+'"></div>'),e&&i.append('<h3 class="property-grp__title">'+e+"</h3>"),i},t.prototype.getContainer=function(t){var e;return e=!1,t.id&&(e=$("#property--"+t.id),e.length||(e=e=$('<div class="properties__wrapper" id="property--'+t.id+'"></div>'),this.$el.append(e),t.label&&e.append('<h2 class="properties-editor__title">'+t.label+"</h2>"))),e===!1&&(e=$('<div class="properties__wrapper" id="no-item"></div>'),this.$el.append(e)),e},t.prototype.addNumberProperty=function(t,e,i,n){var a,o;return o=s,t.type&&"color"===t.type&&(o=r),a=new o(t,e,this.editor,i),a.keyAdded.add(this.onKeyAdded),n.append(a.$el),a},t.prototype.addTweenProperty=function(t,e,i,n,r,s){var o;return o=new a(t,e,this.editor,i,this.timeline),n.append(o.$el),o.$el.find("[data-action-remove]").click(function(t){return function(n){var a;return n.preventDefault(),a=r.keys.indexOf(i),a>-1?(r.keys.splice(a,1),t.editor.propertiesEditor.keyRemoved.dispatch(s),e._isDirty=!0):void 0}}(this)),o},t.prototype.update=function(){var t,e,i,n;for(n=this.items,e=0,i=n.length;i>e;e++)t=n[e],t.update()},t}(),t.exports=n},function(t){t.exports='<div class=properties-editor><a href=# class="menu-item menu-item--toggle-side" data-action=toggle><i class=icon-toggle></i></a><div class=properties-editor__main></div></div>'},function(t,e,i){var n,r,s,a,o,l,h,u,p,d,c=function(t,e){return function(){return t.apply(e,arguments)}},m={}.hasOwnProperty,f=function(t,e){function i(){this.constructor=t}for(var n in e)m.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};n=i(15),l=i(13),d=i(1),u=i(16),h=i(2),a=i(34),r=i(31),s=i(32),console.log(s),p=i(35),o=function(t){function e(t,i,n,r){this.instance_property=t,this.lineData=i,this.editor=n,this.key_val=null!=r?r:!1,this.update=c(this.update,this),this.render=c(this.render,this),this.getInputVal=c(this.getInputVal,this),e.__super__.constructor.apply(this,arguments),this.$input=this.$el.find("input")}return f(e,t),e.prototype.getInputVal=function(){return parseFloat(this.$el.find("input").val())},e.prototype.render=function(){var t,i,a,o,l,h;return e.__super__.render.apply(this,arguments),l=this.getCurrentVal(),i={id:this.instance_property.name,label:this.instance_property.label||this.instance_property.name,val:l},h=s.render(p,i),this.$el=n(h),this.$el.find(".property__key").click(this.onKeyClick),t=this.$el.find("input"),o=function(t){return function(){return t.editor.undoManager.addState()}}(this),a=new r(t.get(0),{changeCallback:this.onInputChange,endCallback:o}),t.data("draggable",a),t.change(this.onInputChange)},e.prototype.update=function(){var t,i;return e.__super__.update.apply(this,arguments),i=this.getCurrentVal(),t=this.$input.data("draggable"),t?t.set(i.toFixed(3)):this.$input.val(i.toFixed(3))},e}(a),t.exports=o},function(t,e,i){var n,r,s,a,o,l,h,u,p,d=function(t,e){return function(){return t.apply(e,arguments)}},c={}.hasOwnProperty,m=function(t,e){function i(){this.constructor=t}for(var n in e)c.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};n=i(15),i(33),o=i(13),p=i(1),h=i(16),l=i(2),s=i(34),r=i(32),u=i(36),a=function(t){function e(t,i,n,r){this.instance_property=t,this.lineData=i,this.editor=n,this.key_val=null!=r?r:!1,this.update=d(this.update,this),this.render=d(this.render,this),e.__super__.constructor.apply(this,arguments),this.$input=this.$el.find("input")}return m(e,t),e.prototype.render=function(){var t,i,s,a;return e.__super__.render.apply(this,arguments),s=this.getCurrentVal(),i={id:this.instance_property.name,label:this.instance_property.label||this.instance_property.name,val:s},a=r.render(u,i),this.$el=n(a),this.$el.find(".property__key").click(this.onKeyClick),t=this.$el.find("input"),t.spectrum({allowEmpty:!1,showAlpha:!0,clickoutFiresChange:!1,preferredFormat:"rgb",change:function(t){return function(){return t.editor.undoManager.addState()}}(this),move:function(t){return function(e){return t.$input.val(1===e._a?e.toHexString():e.toRgbString()),t.onInputChange()}}(this)}),t.change(this.onInputChange)},e.prototype.update=function(){var t;return e.__super__.update.apply(this,arguments),t=this.getCurrentVal(),this.$input.val(t),this.$input.spectrum("set",t)},e}(s),t.exports=a},function(t,e,i){var n,r,s,a,o,l=function(t,e){return function(){return t.apply(e,arguments)}};n=i(15),a=i(13),r=i(32),o=i(!function(){var t=new Error('Cannot find module "html!../templates/propertyTween.tpl.html"');throw t.code="MODULE_NOT_FOUND",t}()),s=function(){function t(t,e,i,n,r){this.instance_property=t,this.lineData=e,this.editor=i,this.key_val=null!=n?n:!1,this.timeline=r,this.update=l(this.update,this),this.onChange=l(this.onChange,this),this.updateKeyTime=l(this.updateKeyTime,this),this.render=l(this.render,this),this.timer=this.editor.timer,this.$time=!1,this.render()}return t.prototype.render=function(){var t,e,i,s,a,l;for(e=this,this.key_val.ease||(this.key_val.ease="Quad.easeOut"),t={id:this.instance_property.name+"_tween",val:this.key_val.ease,time:this.key_val.time.toFixed(3),options:["Linear.easeNone"],selected:function(){return this.toString()===e.key_val.ease?"selected":""}},s=["Quad","Cubic","Quart","Quint","Strong"],a=0,l=s.length;l>a;a++)i=s[a],t.options.push(i+".easeOut"),t.options.push(i+".easeIn"),t.options.push(i+".easeInOut");this.$el=n(r.render(o,t)),this.$time=this.$el.find(".property__key-time strong"),this.$time.keypress(function(t){return function(e){return 13===e.charCode?(e.preventDefault(),t.$time.blur(),t.updateKeyTime(t.$time.text())):void 0}}(this)),this.$time.on("click",function(){return document.execCommand("selectAll",!1,null)}),this.$el.find("select").change(this.onChange)},t.prototype.updateKeyTime=function(t){return t=parseFloat(t),isNaN(t)&&(t=this.key_val.time),this.$time.text(t),this.key_val.time=t,this.onChange()},t.prototype.onChange=function(){var t;t=this.$el.find("select").val(),this.key_val.ease=t,this.editor.undoManager.addState(),this.lineData._isDirty=!0,this.timeline._isDirty=!0},t.prototype.update=function(){this.$time.html(this.key_val.time.toFixed(3))},t}(),t.exports=s},function(t,e,i){var n,r;(function(t){"use strict";var s=s||"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob.bind(navigator)||function(t){if("undefined"==typeof navigator||!/MSIE [1-9]\./.test(navigator.userAgent)){var e=t.document,i=function(){return t.URL||t.webkitURL||t},n=e.createElementNS("http://www.w3.org/1999/xhtml","a"),r="download"in n,s=function(i){var n=e.createEvent("MouseEvents");n.initMouseEvent("click",!0,!1,t,0,0,0,0,0,!1,!1,!1,!1,0,null),i.dispatchEvent(n)},a=t.webkitRequestFileSystem,o=t.requestFileSystem||a||t.mozRequestFileSystem,l=function(e){(t.setImmediate||t.setTimeout)(function(){throw e},0)},h="application/octet-stream",u=0,p=10,d=function(e){var n=function(){"string"==typeof e?i().revokeObjectURL(e):e.remove()};t.chrome?n():setTimeout(n,p)},c=function(t,e,i){e=[].concat(e);for(var n=e.length;n--;){var r=t["on"+e[n]];if("function"==typeof r)try{r.call(t,i||t)}catch(s){l(s)}}},m=function(e,l){var p,m,f,g=this,y=e.type,v=!1,_=function(){c(g,"writestart progress write writeend".split(" "))},x=function(){if((v||!p)&&(p=i().createObjectURL(e)),m)m.location.href=p;else{var n=t.open(p,"_blank");void 0==n&&"undefined"!=typeof safari&&(t.location.href=p)}g.readyState=g.DONE,_(),d(p)},w=function(t){return function(){return g.readyState!==g.DONE?t.apply(this,arguments):void 0}},k={create:!0,exclusive:!1};return g.readyState=g.INIT,l||(l="download"),r?(p=i().createObjectURL(e),n.href=p,n.download=l,s(n),g.readyState=g.DONE,_(),void d(p)):(t.chrome&&y&&y!==h&&(f=e.slice||e.webkitSlice,e=f.call(e,0,e.size,h),v=!0),a&&"download"!==l&&(l+=".download"),(y===h||a)&&(m=t),o?(u+=e.size,void o(t.TEMPORARY,u,w(function(t){t.root.getDirectory("saved",k,w(function(t){var i=function(){t.getFile(l,k,w(function(t){t.createWriter(w(function(i){i.onwriteend=function(e){m.location.href=t.toURL(),g.readyState=g.DONE,c(g,"writeend",e),d(t)},i.onerror=function(){var t=i.error;t.code!==t.ABORT_ERR&&x()},"writestart progress write abort".split(" ").forEach(function(t){i["on"+t]=g["on"+t]}),i.write(e),g.abort=function(){i.abort(),g.readyState=g.DONE},g.readyState=g.WRITING}),x)}),x)};t.getFile(l,{create:!1},w(function(t){t.remove(),i()}),w(function(t){t.code===t.NOT_FOUND_ERR?i():x()}))}),x)}),x)):void x())},f=m.prototype,g=function(t,e){return new m(t,e)};return f.abort=function(){var t=this;t.readyState=t.DONE,c(t,"abort")},f.readyState=f.INIT=0,f.WRITING=1,f.DONE=2,f.error=f.onwritestart=f.onprogress=f.onwrite=f.onabort=f.onerror=f.onwriteend=null,g}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);"undefined"!=typeof t&&null!==t?t.exports=s:null!==i(38)&&null!=i(39)&&(n=[],r=function(){return s}.apply(e,n),!(void 0!==r&&(t.exports=r)))}).call(e,i(40)(t))},function(t){t.exports=r},function(t){t.exports=s},function(t){t.exports=a},function(t,e,i){var n,r,s,a,o,l,h,u=function(t,e){return function(){return t.apply(e,arguments)}};n=i(15),a=i(13),h=i(1),o=i(2),r=i(32),l=i(35),s=function(){function t(t,e,i,n){this.instance_property=t,this.lineData=e,this.editor=i,this.key_val=null!=n?n:!1,this.update=u(this.update,this),this.render=u(this.render,this),this.addKey=u(this.addKey,this),this.getCurrentKey=u(this.getCurrentKey,this),this.onInputChange=u(this.onInputChange,this),this.getCurrentVal=u(this.getCurrentVal,this),this.getInputVal=u(this.getInputVal,this),this.onKeyClick=u(this.onKeyClick,this),this.timer=this.editor.timer,this.keyAdded=new a.Signal,this.render(),this.$key=this.$el.find(".property__key")}return t.prototype.onKeyClick=function(t){var e;return t.preventDefault(),e=this.getCurrentVal(),this.addKey(e)},t.prototype.getInputVal=function(){return this.$el.find("input").val()},t.prototype.getCurrentVal=function(){var t,e;return e=this.instance_property.val,t=this.instance_property.name,this.key_val?this.key_val.val:null!=this.lineData.values&&this.lineData.values[t]?this.lineData.values[t]:e},t.prototype.onInputChange=function(){var t,e,i;return i=this.getInputVal(),t=this.timer.getCurrentTime()/1e3,this.key_val&&(t=this.key_val.time),this.instance_property.keys&&this.instance_property.keys.length?(e=h.find(this.instance_property.keys,function(){return function(e){return e.time===t}}(this)),e?e.val=i:this.addKey(i)):(this.instance_property.val=i,this.lineData.values[this.instance_property.name]=i,this.lineData.object&&(t=this.timer.getCurrentTime()/1e3,this.lineData.object.update(t-this.lineData.start))),this.lineData._isDirty=!0},t.prototype.getCurrentKey=function(){var t,e,i,n,r;if(e=this.timer.getCurrentTime()/1e3,!this.instance_property||!this.instance_property.keys)return!1;if(0===this.instance_property.keys.length)return!1;for(r=this.instance_property.keys,i=0,n=r.length;n>i;i++)if(t=r[i],t.time===e)return t;return!1},t.prototype.addKey=function(t){var e,i;return e=this.timer.getCurrentTime()/1e3,i={time:e,val:t},this.instance_property.keys.push(i),this.instance_property.keys=o.sortKeys(this.instance_property.keys),this.lineData._isDirty=!0,this.keyAdded.dispatch()},t.prototype.render=function(){return this.values=null!=this.lineData.values?this.lineData.values:{}},t.prototype.update=function(){var t;return t=this.getCurrentKey(),this.$key.toggleClass("property__key--active",t)},t}(),t.exports=s},function(t){t.exports='<div class="property property--number"><button class=property__key></button><label for={{id}} class=property__label>{{label}}</label><input type=number id={{id}} class=property__input value={{val}}></div>'},function(t){t.exports='<div class="property property--number"><button class=property__key></button><label for={{id}} class=property__label>{{label}}</label><input id={{id}} class=property__input value={{val}}></div>'},,function(t){t.exports=function(){throw new Error("define cannot be used indirect")}},function(t,e){(function(e){t.exports=e}).call(e,{})},function(t){"use strict";t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}}])});
//# sourceMappingURL=TweenTime.Editor.js.map